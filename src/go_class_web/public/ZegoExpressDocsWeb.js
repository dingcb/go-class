!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var o=t();for(var i in o)("object"==typeof exports?exports:e)[i]=o[i]}}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function o(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(i,r,function(t){return e[t]}.bind(null,r));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=50)}([function(e,t,o){"use strict";var i=o(7),r=Object.prototype.toString;function n(e){return"[object Array]"===r.call(e)}function s(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===r.call(e)}function h(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),n(e))for(var o=0,i=e.length;o<i;o++)t.call(null,e[o],o,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}e.exports={isArray:n,isArrayBuffer:function(e){return"[object ArrayBuffer]"===r.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:s,isDate:function(e){return"[object Date]"===r.call(e)},isFile:function(e){return"[object File]"===r.call(e)},isBlob:function(e){return"[object Blob]"===r.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:h,merge:function e(){var t={};function o(o,i){"object"==typeof t[i]&&"object"==typeof o?t[i]=e(t[i],o):t[i]=o}for(var i=0,r=arguments.length;i<r;i++)h(arguments[i],o);return t},deepMerge:function e(){var t={};function o(o,i){"object"==typeof t[i]&&"object"==typeof o?t[i]=e(t[i],o):t[i]="object"==typeof o?e({},o):o}for(var i=0,r=arguments.length;i<r;i++)h(arguments[i],o);return t},extend:function(e,t,o){return h(t,(function(t,r){e[r]=o&&"function"==typeof t?i(t,o):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,o){var i;e.exports=(i=i||function(e,t){var o=Object.create||function(){function e(){}return function(t){var o;return e.prototype=t,o=new e,e.prototype=null,o}}(),i={},r=i.lib={},n=r.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,o=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var n=0;n<r;n++){var s=o[n>>>2]>>>24-n%4*8&255;t[i+n>>>2]|=s<<24-(i+n)%4*8}else for(n=0;n<r;n+=4)t[i+n>>>2]=o[n>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,o=this.sigBytes;t[o>>>2]&=4294967295<<32-o%4*8,t.length=e.ceil(o/4)},clone:function(){var e=n.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var o,i=[],r=function(t){t=t;var o=987654321,i=4294967295;return function(){var r=((o=36969*(65535&o)+(o>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return r/=4294967296,(r+=.5)*(e.random()>.5?1:-1)}},n=0;n<t;n+=4){var a=r(4294967296*(o||e.random()));o=987654071*a(),i.push(4294967296*a()|0)}return new s.init(i,t)}}),a=i.enc={},c=a.Hex={stringify:function(e){for(var t=e.words,o=e.sigBytes,i=[],r=0;r<o;r++){var n=t[r>>>2]>>>24-r%4*8&255;i.push((n>>>4).toString(16)),i.push((15&n).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,o=[],i=0;i<t;i+=2)o[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new s.init(o,t/2)}},h=a.Latin1={stringify:function(e){for(var t=e.words,o=e.sigBytes,i=[],r=0;r<o;r++){var n=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(n))}return i.join("")},parse:function(e){for(var t=e.length,o=[],i=0;i<t;i++)o[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new s.init(o,t)}},f=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var o=this._data,i=o.words,r=o.sigBytes,n=this.blockSize,a=r/(4*n),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*n,h=e.min(4*c,r);if(c){for(var f=0;f<c;f+=n)this._doProcessBlock(i,f);var p=i.splice(0,c);o.sigBytes-=h}return new s.init(p,h)},clone:function(){var e=n.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),l=(r.Hasher=p.extend({cfg:n.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,o){return new e.init(o).finalize(t)}},_createHmacHelper:function(e){return function(t,o){return new l.HMAC.init(e,o).finalize(t)}}}),i.algo={});return i}(Math),i)},,function(e,t,o){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=t.getLogAction=void 0;var r=function(){function e(e,t){this.appid="",this.roomid="",this.userid="",this.token="",this.isTestEnv=!0,this.version="",this.platform="",this.extra={},this.isProd=!1,this.isElectron=!1,this.logCacheSend=[],this.logCacheMax=100,this.platform=e||"",this.isElectron=t,this.openLogServer()}return e.prototype.init=function(e){var t=e.appid,o=e.isTestEnv,i=e.version,r=e.isProd,n=e.liveroom;this.appid=(t||this.appid)+"",this.isTestEnv=o,this.version=i||this.version,this.isProd=r,n&&!this.platform.includes("liveroom")&&(this.platform+=",liveroom")},e.prototype.initRoom=function(e){var t=e.roomid,o=e.userid,i=e.token;this.roomid=t||this.roomid,this.userid=o||this.userid,this.token=i||this.token},e.prototype.setExtraConfig=function(e){Object.assign(this.extra,e)},e.prototype.getConfig=function(){return{appid:+this.appid,roomid:this.roomid,userid:this.userid,token:this.token,isTestEnv:this.isTestEnv}},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(0,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(1,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(2,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(3,e)},e.prototype.writeLocalLog=function(e){},e.prototype.log=function(e,t){var o=this.isProd||this.isElectron?this.logParamList(e,t.join("")):t.join("");return this.isProd&&this.remoteWebSocketLog(e,o),this.isElectron&&this.writeLocalLog(o),o},e.prototype.openLogServer=function(){this.stopWebSocketServer(),this.websocket=new WebSocket("wss://weblogger-edu.zego.im/log")},e.prototype.stopWebSocketServer=function(){this.websocket&&(this.websocket.close(),this.websocket=null)},e.prototype.remoteWebSocketLog=function(e,t){if(!("string"==typeof t&&t.length>4e3))if(null==this.websocket||2==this.websocket.readyState||3==this.websocket.readyState)this.openLogServer(),this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t);else if(0==this.websocket.readyState)this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t);else if(1==this.websocket.readyState)if(this.logCacheSend.length>0){for(var o="",i=0;i<this.logCacheSend.length;i++)(o+this.logCacheSend[i]).length>4e3&&(this.websocket.send(o),o=""),o=o+this.logCacheSend[i]+"\n";t=o+t,this.logCacheSend=[],this.websocket.send(t)}else this.websocket.send(t);else this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t)},e.prototype.logParamList=function(e,t){var o=(new Date).toLocaleString(),r=t.indexOf(" "),n=t.substr(0,r)||t,s=t.substr(r+1,4500),a=i(i({time:o,level:e,action:n,content:s,appid:this.appid,userid:this.userid,roomid:this.roomid},this.extra),{version:this.version,platform:this.platform});return JSON.stringify(a)},e}(),n=function(e,t,o){var i=!(!e||!e.versions.electron);return{electron:i,platform:(i?e.platform:t)+","+o[o.length-2]+","+o[o.length-1]}}(window.process,navigator.platform,navigator.userAgent.split(" ")),s=n.electron,a=n.platform,c=s?"ec.":"web.";t.getLogAction=function(e,t){return""+c+e+t+" "},t.Logger=window.zegoLogger||(window.zegoLogger=new r(a,s))},function(e,t,o){"use strict";var i,r=this&&this.__createBinding||(Object.create?function(e,t,o,i){void 0===i&&(i=o),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,i){void 0===i&&(i=o),e[i]=t[o]}),n=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||t.hasOwnProperty(o)||r(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),t.transError=t.ExpectFileType=t.RenderMode=t.DOMIDS=t.SYNC_PPT_INIT_TIME=t.SYNC_PPT_TIME=t.INTERVAL_PAGE=void 0;var s=o(15);n(o(15),t),t.INTERVAL_PAGE=100,t.SYNC_PPT_TIME=1e3,t.SYNC_PPT_INIT_TIME=2e4,t.DOMIDS={zoom:"zego-docsview-zoom",doc:"zego-docsview-con",render:"zego-docsview-render",iframe:"zego-docsview-iframe",wb:"zego-whiteboard"},function(e){e[e.PDF=0]="PDF",e[e.PPT=1]="PPT",e[e.H5=2]="H5"}(t.RenderMode||(t.RenderMode={})),function(e){e[e.PPT=1]="PPT",e[e.DOC=2]="DOC",e[e.ELS=4]="ELS",e[e.PDF=8]="PDF",e[e.IMG=16]="IMG",e[e.TXT=32]="TXT",e[e.H5=64]="H5",e[e.H5PDF=128]="H5PDF",e[e.IMGAndPDF=256]="IMGAndPDF",e[e.PPTH5=512]="PPTH5"}(t.ExpectFileType||(t.ExpectFileType={}));var a=((i={30001:"请求过于频繁",60011:"token无效",60012:"token已过期",60013:"文档转换请求已处理",60014:"不存在的任务ID",60015:"不支持的文件类型"})[s.ZegoDocsViewError.ZegoDocsViewSuccess]="执行成功",i[s.ZegoDocsViewError.ZegoDocsViewErrorInternal]="内部错误",i[s.ZegoDocsViewError.ZegoDocsViewErrorParamInvalid]="参数错误",i[s.ZegoDocsViewError.ZegoDocsViewErrorNetworkTimeout]="网络超时",i[s.ZegoDocsViewError.ZegoDocsViewErrorFileNotExist]="文件不存在",i[s.ZegoDocsViewError.ZegoDocsViewErrorUploadFailed]="上传失败",i[s.ZegoDocsViewError.ZegoDocsViewErrorUnsupportRenderType]="不支持渲染模式",i[s.ZegoDocsViewError.ZegoDocsViewErrorFileEncrypt]="文件被加密",i[s.ZegoDocsViewError.ZegoDocsViewErrorFileSizeLimit]="文件内容过大",i[s.ZegoDocsViewError.ZegoDocsViewErrorFileSheetLimit]="Excel 文件 sheet 过多",i[s.ZegoDocsViewError.ZegoDocsViewErrorConvertFail]="格式转换失败",i[s.ZegoDocsViewError.ZegoDocsViewErrorConvertCancel]="格式转换被取消",i[s.ZegoDocsViewError.ZegoDocsViewErrorFileEmpty]="文件内容为空",i[s.ZegoDocsViewError.ZegoDocsViewErrorAuthParamInvalid]="认证参数错误",i[s.ZegoDocsViewError.ZegoDocsViewErrorFilePathNotAccess]="路径权限不足",i[s.ZegoDocsViewError.ZegoDocsViewErrorInitFailed]="初始化失败",i[s.ZegoDocsViewError.ZegoDocsViewErrorSizeInvalid]="无法获取当前 view 宽高",i[s.ZegoDocsViewError.ZegoDocsViewErrorFreeSpaceLimit]="本地空间不足",i[s.ZegoDocsViewError.ZegoDocsViewErrorUploadNotSupported]="不支持文件上传功能",i[s.ZegoDocsViewError.ZegoDocsViewErrorUploadDuplicated]="正在上传相同文件",i[s.ZegoDocsViewError.ZegoDocsViewErrorEmptyDomain]="空域名",i[s.ZegoDocsViewError.ZegoDocsViewErrorHaveInit]="已初始化",i),c={4:s.ZegoDocsViewError.ZegoDocsViewErrorParamInvalid,32:s.ZegoDocsViewError.ZegoDocsViewErrorConvertFail,64:s.ZegoDocsViewError.ZegoDocsViewErrorConvertCancel,128:s.ZegoDocsViewError.ZegoDocsViewErrorFileEncrypt,256:s.ZegoDocsViewError.ZegoDocsViewErrorFileSizeLimit,512:s.ZegoDocsViewError.ZegoDocsViewErrorFileSheetLimit,1024:s.ZegoDocsViewError.ZegoDocsViewErrorFileEmpty,60002:s.ZegoDocsViewError.ZegoDocsViewErrorFileNotExist,60013:s.ZegoDocsViewError.ZegoDocsViewErrorConvertCancel,"-102":s.ZegoDocsViewError.ZegoDocsViewErrorNetworkTimeout,"-105":s.ZegoDocsViewError.ZegoDocsViewErrorFileNotExist,"-109":s.ZegoDocsViewError.ZegoDocsViewErrorUploadFailed,"-110":s.ZegoDocsViewError.ZegoDocsViewErrorFilePathNotAccess,"-115":s.ZegoDocsViewError.ZegoDocsViewErrorFreeSpaceLimit,"-116":s.ZegoDocsViewError.ZegoDocsViewErrorInitFailed,"-117":s.ZegoDocsViewError.ZegoDocsViewErrorFileSizeLimit,"-118":s.ZegoDocsViewError.ZegoDocsViewErrorUploadNotSupported,"-119":s.ZegoDocsViewError.ZegoDocsViewErrorUploadDuplicated,"-120":s.ZegoDocsViewError.ZegoDocsViewErrorUnsupportRenderType,"-999998":s.ZegoDocsViewError.ZegoDocsViewErrorSizeInvalid,"-999999":s.ZegoDocsViewError.ZegoDocsViewErrorParamInvalid};t.transError=function(e,t){return{code:e=c[e]||e,message:t=a[e]&&t?t:a[e]||t||a[s.ZegoDocsViewError.ZegoDocsViewErrorInternal]}}},function(e,t,o){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,o,i){void 0===i&&(i=o),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,i){void 0===i&&(i=o),e[i]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||t.hasOwnProperty(o)||i(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),t.PPTSuffixEnum=t.WORDSuffixEnum=t.EXCELSuffixEnum=t.PDFSuffixEnum=t.IMGSuffixEnum=t.TXTSuffixEnum=t.UPLOAD_HTTP_TIME=t.HTTP_TIME=void 0,r(o(4),t),t.HTTP_TIME=1e4,t.UPLOAD_HTTP_TIME=36e5,function(e){e[e.TXT=0]="TXT",e[e.MD=1]="MD",e[e.C=2]="C",e[e.CPP=3]="CPP",e[e.H=4]="H",e[e.HPP=5]="HPP",e[e.PY=6]="PY",e[e.JS=7]="JS",e[e.XML=8]="XML"}(t.TXTSuffixEnum||(t.TXTSuffixEnum={})),function(e){e[e.JPG=0]="JPG",e[e.JPEG=1]="JPEG",e[e.PNG=2]="PNG",e[e.BMP=3]="BMP",e[e.SVG=4]="SVG",e[e.HEIC=5]="HEIC"}(t.IMGSuffixEnum||(t.IMGSuffixEnum={})),function(e){e[e.PDF=0]="PDF"}(t.PDFSuffixEnum||(t.PDFSuffixEnum={})),function(e){e[e.XLSX=0]="XLSX",e[e.XLS=1]="XLS"}(t.EXCELSuffixEnum||(t.EXCELSuffixEnum={})),function(e){e[e.DOC=0]="DOC",e[e.DOCX=1]="DOCX"}(t.WORDSuffixEnum||(t.WORDSuffixEnum={})),function(e){e[e.PPT=0]="PPT",e[e.PPTX=1]="PPTX"}(t.PPTSuffixEnum||(t.PPTSuffixEnum={}))},,function(e,t,o){"use strict";e.exports=function(e,t){return function(){for(var o=new Array(arguments.length),i=0;i<o.length;i++)o[i]=arguments[i];return e.apply(t,o)}}},function(e,t,o){"use strict";var i=o(0);function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,o){if(!t)return e;var n;if(o)n=o(t);else if(i.isURLSearchParams(t))n=t.toString();else{var s=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),s.push(r(t)+"="+r(e))})))})),n=s.join("&")}if(n){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e}},function(e,t,o){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,o){"use strict";(function(t){var i=o(0),r=o(31),n={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(a=o(11)),a),transformRequest:[function(e,t){return r(t,"Accept"),r(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){c.headers[e]=i.merge(n)})),e.exports=c}).call(this,o(30))},function(e,t,o){"use strict";var i=o(0),r=o(32),n=o(8),s=o(34),a=o(37),c=o(38),h=o(12);e.exports=function(e){return new Promise((function(t,f){var p=e.data,l=e.headers;i.isFormData(p)&&delete l["Content-Type"];var u=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",g=e.auth.password||"";l.Authorization="Basic "+btoa(d+":"+g)}var v=s(e.baseURL,e.url);if(u.open(e.method.toUpperCase(),n(v,e.params,e.paramsSerializer),!0),u.timeout=e.timeout,u.onreadystatechange=function(){if(u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))){var o="getAllResponseHeaders"in u?a(u.getAllResponseHeaders()):null,i={data:e.responseType&&"text"!==e.responseType?u.response:u.responseText,status:u.status,statusText:u.statusText,headers:o,config:e,request:u};r(t,f,i),u=null}},u.onabort=function(){u&&(f(h("Request aborted",e,"ECONNABORTED",u)),u=null)},u.onerror=function(){f(h("Network Error",e,null,u)),u=null},u.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),f(h(t,e,"ECONNABORTED",u)),u=null},i.isStandardBrowserEnv()){var m=o(39),y=(e.withCredentials||c(v))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;y&&(l[e.xsrfHeaderName]=y)}if("setRequestHeader"in u&&i.forEach(l,(function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete l[t]:u.setRequestHeader(t,e)})),i.isUndefined(e.withCredentials)||(u.withCredentials=!!e.withCredentials),e.responseType)try{u.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&u.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){u&&(u.abort(),f(e),u=null)})),void 0===p&&(p=null),u.send(p)}))}},function(e,t,o){"use strict";var i=o(33);e.exports=function(e,t,o,r,n){var s=new Error(e);return i(s,t,o,r,n)}},function(e,t,o){"use strict";var i=o(0);e.exports=function(e,t){t=t||{};var o={},r=["url","method","params","data"],n=["headers","auth","proxy"],s=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];i.forEach(r,(function(e){void 0!==t[e]&&(o[e]=t[e])})),i.forEach(n,(function(r){i.isObject(t[r])?o[r]=i.deepMerge(e[r],t[r]):void 0!==t[r]?o[r]=t[r]:i.isObject(e[r])?o[r]=i.deepMerge(e[r]):void 0!==e[r]&&(o[r]=e[r])})),i.forEach(s,(function(i){void 0!==t[i]?o[i]=t[i]:void 0!==e[i]&&(o[i]=e[i])}));var a=r.concat(n).concat(s),c=Object.keys(t).filter((function(e){return-1===a.indexOf(e)}));return i.forEach(c,(function(i){void 0!==t[i]?o[i]=t[i]:void 0!==e[i]&&(o[i]=e[i])})),o}},function(e,t,o){"use strict";function i(e){this.message=e}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,e.exports=i},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsViewUploadState=t.ZegoDocsViewRenderType=t.ZegoDocsViewFileType=t.ZegoDocsViewError=t.ZegoConfigKey=void 0,function(e){e.DisableH5ImageDrag="disableH5ImageDrag",e.DynamicPPTHD="dynamicPPTHD",e.PptStepMode="pptStepMode",e.Domain="domain"}(t.ZegoConfigKey||(t.ZegoConfigKey={})),function(e){e[e.ZegoDocsViewSuccess=0]="ZegoDocsViewSuccess",e[e.ZegoDocsViewErrorInternal=2000001]="ZegoDocsViewErrorInternal",e[e.ZegoDocsViewErrorParamInvalid=2000002]="ZegoDocsViewErrorParamInvalid",e[e.ZegoDocsViewErrorNetworkTimeout=2000003]="ZegoDocsViewErrorNetworkTimeout",e[e.ZegoDocsViewErrorFileNotExist=2010001]="ZegoDocsViewErrorFileNotExist",e[e.ZegoDocsViewErrorUploadFailed=2010002]="ZegoDocsViewErrorUploadFailed",e[e.ZegoDocsViewErrorUnsupportRenderType=2010003]="ZegoDocsViewErrorUnsupportRenderType",e[e.ZegoDocsViewErrorFileEncrypt=2020001]="ZegoDocsViewErrorFileEncrypt",e[e.ZegoDocsViewErrorFileSizeLimit=2020002]="ZegoDocsViewErrorFileSizeLimit",e[e.ZegoDocsViewErrorFileSheetLimit=2020003]="ZegoDocsViewErrorFileSheetLimit",e[e.ZegoDocsViewErrorConvertFail=2020004]="ZegoDocsViewErrorConvertFail",e[e.ZegoDocsViewErrorConvertCancel=2020005]="ZegoDocsViewErrorConvertCancel",e[e.ZegoDocsViewErrorFileEmpty=2020006]="ZegoDocsViewErrorFileEmpty",e[e.ZegoDocsViewErrorAuthParamInvalid=2030001]="ZegoDocsViewErrorAuthParamInvalid",e[e.ZegoDocsViewErrorFilePathNotAccess=2030002]="ZegoDocsViewErrorFilePathNotAccess",e[e.ZegoDocsViewErrorInitFailed=2030003]="ZegoDocsViewErrorInitFailed",e[e.ZegoDocsViewErrorSizeInvalid=2030004]="ZegoDocsViewErrorSizeInvalid",e[e.ZegoDocsViewErrorFreeSpaceLimit=2030005]="ZegoDocsViewErrorFreeSpaceLimit",e[e.ZegoDocsViewErrorUploadNotSupported=2030006]="ZegoDocsViewErrorUploadNotSupported",e[e.ZegoDocsViewErrorUploadDuplicated=2030007]="ZegoDocsViewErrorUploadDuplicated",e[e.ZegoDocsViewErrorEmptyDomain=2030008]="ZegoDocsViewErrorEmptyDomain",e[e.ZegoDocsViewErrorHaveInit=2030009]="ZegoDocsViewErrorHaveInit"}(t.ZegoDocsViewError||(t.ZegoDocsViewError={})),function(e){e[e.ZegoDocsViewFileTypeUnknown=0]="ZegoDocsViewFileTypeUnknown",e[e.ZegoDocsViewFileTypePPT=1]="ZegoDocsViewFileTypePPT",e[e.ZegoDocsViewFileTypeDOC=2]="ZegoDocsViewFileTypeDOC",e[e.ZegoDocsViewFileTypeELS=4]="ZegoDocsViewFileTypeELS",e[e.ZegoDocsViewFileTypePDF=8]="ZegoDocsViewFileTypePDF",e[e.ZegoDocsViewFileTypeIMG=16]="ZegoDocsViewFileTypeIMG",e[e.ZegoDocsViewFileTypeTXT=32]="ZegoDocsViewFileTypeTXT",e[e.ZegoDocsViewFileTypeDynamicPPTH5=512]="ZegoDocsViewFileTypeDynamicPPTH5",e[e.ZegoDocsViewFileTypeAudio=1024]="ZegoDocsViewFileTypeAudio",e[e.ZegoDocsViewFileTypeVideo=2048]="ZegoDocsViewFileTypeVideo"}(t.ZegoDocsViewFileType||(t.ZegoDocsViewFileType={})),function(e){e[e.ZegoDocsViewRenderTypeVector=1]="ZegoDocsViewRenderTypeVector",e[e.ZegoDocsViewRenderTypeIMG=2]="ZegoDocsViewRenderTypeIMG",e[e.ZegoDocsViewRenderTypeVectorAndIMG=3]="ZegoDocsViewRenderTypeVectorAndIMG",e[e.ZegoDocsViewRenderTypeDynamicPPTH5=6]="ZegoDocsViewRenderTypeDynamicPPTH5"}(t.ZegoDocsViewRenderType||(t.ZegoDocsViewRenderType={})),function(e){e[e.UPLOADING=1]="UPLOADING",e[e.UPLOADED=2]="UPLOADED",e[e.WAITING=4]="WAITING",e[e.CONVERTING=8]="CONVERTING",e[e.CONVERTED=16]="CONVERTED",e[e.CONVERT_FAIL=32]="CONVERT_FAIL",e[e.CONVERT_CANCEL=64]="CONVERT_CANCEL"}(t.ZegoDocsViewUploadState||(t.ZegoDocsViewUploadState={}))},function(e,t,o){var i,r,n;e.exports=(n=o(1),r=(i=n).lib.WordArray,i.enc.Base64={stringify:function(e){var t=e.words,o=e.sigBytes,i=this._map;e.clamp();for(var r=[],n=0;n<o;n+=3)for(var s=(t[n>>>2]>>>24-n%4*8&255)<<16|(t[n+1>>>2]>>>24-(n+1)%4*8&255)<<8|t[n+2>>>2]>>>24-(n+2)%4*8&255,a=0;a<4&&n+.75*a<o;a++)r.push(i.charAt(s>>>6*(3-a)&63));var c=i.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e){var t=e.length,o=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var n=0;n<o.length;n++)i[o.charCodeAt(n)]=n}var s=o.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return function(e,t,o){for(var i=[],n=0,s=0;s<t;s++)if(s%4){var a=o[e.charCodeAt(s-1)]<<s%4*2,c=o[e.charCodeAt(s)]>>>6-s%4*2;i[n>>>2]|=(a|c)<<24-n%4*8,n++}return r.create(i,n)}(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},n.enc.Base64)},function(e,t,o){var i;e.exports=(i=o(1),function(e){var t=i,o=t.lib,r=o.WordArray,n=o.Hasher,s=t.algo,a=[];!function(){for(var t=0;t<64;t++)a[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=s.MD5=n.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var o=0;o<16;o++){var i=t+o,r=e[i];e[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var n=this._hash.words,s=e[t+0],c=e[t+1],u=e[t+2],d=e[t+3],g=e[t+4],v=e[t+5],m=e[t+6],y=e[t+7],w=e[t+8],D=e[t+9],I=e[t+10],E=e[t+11],T=e[t+12],P=e[t+13],S=e[t+14],C=e[t+15],_=n[0],x=n[1],b=n[2],V=n[3];_=h(_,x,b,V,s,7,a[0]),V=h(V,_,x,b,c,12,a[1]),b=h(b,V,_,x,u,17,a[2]),x=h(x,b,V,_,d,22,a[3]),_=h(_,x,b,V,g,7,a[4]),V=h(V,_,x,b,v,12,a[5]),b=h(b,V,_,x,m,17,a[6]),x=h(x,b,V,_,y,22,a[7]),_=h(_,x,b,V,w,7,a[8]),V=h(V,_,x,b,D,12,a[9]),b=h(b,V,_,x,I,17,a[10]),x=h(x,b,V,_,E,22,a[11]),_=h(_,x,b,V,T,7,a[12]),V=h(V,_,x,b,P,12,a[13]),b=h(b,V,_,x,S,17,a[14]),_=f(_,x=h(x,b,V,_,C,22,a[15]),b,V,c,5,a[16]),V=f(V,_,x,b,m,9,a[17]),b=f(b,V,_,x,E,14,a[18]),x=f(x,b,V,_,s,20,a[19]),_=f(_,x,b,V,v,5,a[20]),V=f(V,_,x,b,I,9,a[21]),b=f(b,V,_,x,C,14,a[22]),x=f(x,b,V,_,g,20,a[23]),_=f(_,x,b,V,D,5,a[24]),V=f(V,_,x,b,S,9,a[25]),b=f(b,V,_,x,d,14,a[26]),x=f(x,b,V,_,w,20,a[27]),_=f(_,x,b,V,P,5,a[28]),V=f(V,_,x,b,u,9,a[29]),b=f(b,V,_,x,y,14,a[30]),_=p(_,x=f(x,b,V,_,T,20,a[31]),b,V,v,4,a[32]),V=p(V,_,x,b,w,11,a[33]),b=p(b,V,_,x,E,16,a[34]),x=p(x,b,V,_,S,23,a[35]),_=p(_,x,b,V,c,4,a[36]),V=p(V,_,x,b,g,11,a[37]),b=p(b,V,_,x,y,16,a[38]),x=p(x,b,V,_,I,23,a[39]),_=p(_,x,b,V,P,4,a[40]),V=p(V,_,x,b,s,11,a[41]),b=p(b,V,_,x,d,16,a[42]),x=p(x,b,V,_,m,23,a[43]),_=p(_,x,b,V,D,4,a[44]),V=p(V,_,x,b,T,11,a[45]),b=p(b,V,_,x,C,16,a[46]),_=l(_,x=p(x,b,V,_,u,23,a[47]),b,V,s,6,a[48]),V=l(V,_,x,b,y,10,a[49]),b=l(b,V,_,x,S,15,a[50]),x=l(x,b,V,_,v,21,a[51]),_=l(_,x,b,V,T,6,a[52]),V=l(V,_,x,b,d,10,a[53]),b=l(b,V,_,x,I,15,a[54]),x=l(x,b,V,_,c,21,a[55]),_=l(_,x,b,V,w,6,a[56]),V=l(V,_,x,b,C,10,a[57]),b=l(b,V,_,x,m,15,a[58]),x=l(x,b,V,_,P,21,a[59]),_=l(_,x,b,V,g,6,a[60]),V=l(V,_,x,b,E,10,a[61]),b=l(b,V,_,x,u,15,a[62]),x=l(x,b,V,_,D,21,a[63]),n[0]=n[0]+_|0,n[1]=n[1]+x|0,n[2]=n[2]+b|0,n[3]=n[3]+V|0},_doFinalize:function(){var t=this._data,o=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;o[r>>>5]|=128<<24-r%32;var n=e.floor(i/4294967296),s=i;o[15+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),o[14+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(o.length+1),this._process();for(var a=this._hash,c=a.words,h=0;h<4;h++){var f=c[h];c[h]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8)}return a},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,o,i,r,n,s){var a=e+(t&o|~t&i)+r+s;return(a<<n|a>>>32-n)+t}function f(e,t,o,i,r,n,s){var a=e+(t&i|o&~i)+r+s;return(a<<n|a>>>32-n)+t}function p(e,t,o,i,r,n,s){var a=e+(t^o^i)+r+s;return(a<<n|a>>>32-n)+t}function l(e,t,o,i,r,n,s){var a=e+(o^(t|~i))+r+s;return(a<<n|a>>>32-n)+t}t.MD5=n._createHelper(c),t.HmacMD5=n._createHmacHelper(c)}(Math),i.MD5)},function(e,t,o){var i,r,n,s,a,c,h,f;e.exports=(f=o(1),r=(i=f).lib,n=r.WordArray,s=r.Hasher,a=i.algo,c=[],h=a.SHA1=s.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var o=this._hash.words,i=o[0],r=o[1],n=o[2],s=o[3],a=o[4],h=0;h<80;h++){if(h<16)c[h]=0|e[t+h];else{var f=c[h-3]^c[h-8]^c[h-14]^c[h-16];c[h]=f<<1|f>>>31}var p=(i<<5|i>>>27)+a+c[h];p+=h<20?1518500249+(r&n|~r&s):h<40?1859775393+(r^n^s):h<60?(r&n|r&s|n&s)-1894007588:(r^n^s)-899497514,a=s,s=n,n=r<<30|r>>>2,r=i,i=p}o[0]=o[0]+i|0,o[1]=o[1]+r|0,o[2]=o[2]+n|0,o[3]=o[3]+s|0,o[4]=o[4]+a|0},_doFinalize:function(){var e=this._data,t=e.words,o=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(o/4294967296),t[15+(i+64>>>9<<4)]=o,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.SHA1=s._createHelper(h),i.HmacSHA1=s._createHmacHelper(h),f.SHA1)},function(e,t,o){var i,r,n,s;e.exports=(i=o(1),n=(r=i).lib.Base,s=r.enc.Utf8,void(r.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));var o=e.blockSize,i=4*o;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var r=this._oKey=t.clone(),n=this._iKey=t.clone(),a=r.words,c=n.words,h=0;h<o;h++)a[h]^=1549556828,c[h]^=909522486;r.sigBytes=n.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,o=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(o))}})))},function(e,t,o){var i;e.exports=(i=o(1),i.enc.Hex)},function(e,t,o){"use strict";var i,r=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},n=function(){var e={};return function(t){if(void 0===e[t]){var o=document.querySelector(t);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}e[t]=o}return e[t]}}(),s=[];function a(e){for(var t=-1,o=0;o<s.length;o++)if(s[o].identifier===e){t=o;break}return t}function c(e,t){for(var o={},i=[],r=0;r<e.length;r++){var n=e[r],c=t.base?n[0]+t.base:n[0],h=o[c]||0,f="".concat(c," ").concat(h);o[c]=h+1;var p=a(f),l={css:n[1],media:n[2],sourceMap:n[3]};-1!==p?(s[p].references++,s[p].updater(l)):s.push({identifier:f,updater:v(l,t),references:1}),i.push(f)}return i}function h(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var r=o.nc;r&&(i.nonce=r)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var s=n(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var f,p=(f=[],function(e,t){return f[e]=t,f.filter(Boolean).join("\n")});function l(e,t,o,i){var r=o?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=p(t,r);else{var n=document.createTextNode(r),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(n,s[t]):e.appendChild(n)}}function u(e,t,o){var i=o.css,r=o.media,n=o.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),n&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var d=null,g=0;function v(e,t){var o,i,r;if(t.singleton){var n=g++;o=d||(d=h(t)),i=l.bind(null,o,n,!1),r=l.bind(null,o,n,!0)}else o=h(t),i=u.bind(null,o,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(o)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var o=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<o.length;i++){var r=a(o[i]);s[r].references--}for(var n=c(e,t),h=0;h<o.length;h++){var f=a(o[h]);0===s[f].references&&(s[f].updater(),s.splice(f,1))}o=n}}}},function(e,t,o){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o=function(e,t){var o=e[1]||"",i=e[3];if(!i)return o;if(t&&"function"==typeof btoa){var r=(s=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),n=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[o].concat(n).concat([r]).join("\n")}var s,a,c;return[o].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(o,"}"):o})).join("")},t.i=function(e,o,i){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(i)for(var n=0;n<this.length;n++){var s=this[n][0];null!=s&&(r[s]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);i&&r[c[0]]||(o&&(c[2]?c[2]="".concat(o," and ").concat(c[2]):c[2]=o),t.push(c))}},t}},function(e,t){!function(){if(-1!==window.navigator.userAgent.indexOf("Trident")){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}e.prototype=window.Event.prototype,window.CustomEvent=e,document.body.scrollTo||(Element.prototype.scrollTo=function(e,t){this.scrollLeft=e,this.scrollTop=t}),document.body.scrollBy||(Element.prototype.scrollBy=function(e,t){this.scrollLeft+=e,this.scrollTop+=t}),FileReader.prototype.readAsBinaryString||(FileReader.prototype.readAsBinaryString=function(e){var t=this,o=new FileReader;o.onload=function(e){for(var i="",r=new Uint8Array(o.result),n=r.byteLength,s=0;s<n;s++)i+=String.fromCharCode(r[s]);t.content=i,t.result=i,t.onload()},o.readAsArrayBuffer(e)})}}()},function(e,t,o){e.exports=o(25)},function(e,t,o){"use strict";var i=o(0),r=o(7),n=o(26),s=o(13);function a(e){var t=new n(e),o=r(n.prototype.request,t);return i.extend(o,n.prototype,t),i.extend(o,t),o}var c=a(o(10));c.Axios=n,c.create=function(e){return a(s(c.defaults,e))},c.Cancel=o(14),c.CancelToken=o(40),c.isCancel=o(9),c.all=function(e){return Promise.all(e)},c.spread=o(41),e.exports=c,e.exports.default=c},function(e,t,o){"use strict";var i=o(0),r=o(8),n=o(27),s=o(28),a=o(13);function c(e){this.defaults=e,this.interceptors={request:new n,response:new n}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[s,void 0],o=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)o=o.then(t.shift(),t.shift());return o},c.prototype.getUri=function(e){return e=a(this.defaults,e),r(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,o){return this.request(i.merge(o||{},{method:e,url:t}))}})),i.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,o,r){return this.request(i.merge(r||{},{method:e,url:t,data:o}))}})),e.exports=c},function(e,t,o){"use strict";var i=o(0);function r(){this.handlers=[]}r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=r},function(e,t,o){"use strict";var i=o(0),r=o(29),n=o(9),s=o(10);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=r(e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return a(e),t.data=r(t.data,t.headers,e.transformResponse),t}),(function(t){return n(t)||(a(e),t&&t.response&&(t.response.data=r(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,o){"use strict";var i=o(0);e.exports=function(e,t,o){return i.forEach(o,(function(o){e=o(e,t)})),e}},function(e,t){var o,i,r=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(o===setTimeout)return setTimeout(e,0);if((o===n||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:n}catch(e){o=n}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var c,h=[],f=!1,p=-1;function l(){f&&c&&(f=!1,c.length?h=c.concat(h):p=-1,h.length&&u())}function u(){if(!f){var e=a(l);f=!0;for(var t=h.length;t;){for(c=h,h=[];++p<t;)c&&c[p].run();p=-1,t=h.length}c=null,f=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];h.push(new d(e,t)),1!==h.length||f||a(u)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,o){"use strict";var i=o(0);e.exports=function(e,t){i.forEach(e,(function(o,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=o,delete e[i])}))}},function(e,t,o){"use strict";var i=o(12);e.exports=function(e,t,o){var r=o.config.validateStatus;!r||r(o.status)?e(o):t(i("Request failed with status code "+o.status,o.config,null,o.request,o))}},function(e,t,o){"use strict";e.exports=function(e,t,o,i,r){return e.config=t,o&&(e.code=o),e.request=i,e.response=r,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,o){"use strict";var i=o(35),r=o(36);e.exports=function(e,t){return e&&!i(t)?r(e,t):t}},function(e,t,o){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,o){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,o){"use strict";var i=o(0),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,o,n,s={};return e?(i.forEach(e.split("\n"),(function(e){if(n=e.indexOf(":"),t=i.trim(e.substr(0,n)).toLowerCase(),o=i.trim(e.substr(n+1)),t){if(s[t]&&r.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([o]):s[t]?s[t]+", "+o:o}})),s):s}},function(e,t,o){"use strict";var i=o(0);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");function r(e){var i=e;return t&&(o.setAttribute("href",i),i=o.href),o.setAttribute("href",i),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}return e=r(window.location.href),function(t){var o=i.isString(t)?r(t):t;return o.protocol===e.protocol&&o.host===e.host}}():function(){return!0}},function(e,t,o){"use strict";var i=o(0);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,o,r,n,s){var a=[];a.push(e+"="+encodeURIComponent(t)),i.isNumber(o)&&a.push("expires="+new Date(o).toGMTString()),i.isString(r)&&a.push("path="+r),i.isString(n)&&a.push("domain="+n),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,o){"use strict";var i=o(14);function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var o=this;e((function(e){o.reason||(o.reason=new i(e),t(o.reason))}))}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r((function(t){e=t})),cancel:e}},e.exports=r},function(e,t,o){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,o){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getUploadOssInfo=t.getMd5=void 0;var r=i(o(43)),n=i(o(17)),s=i(o(45)),a=i(o(46)),c=i(o(20)),h=i(o(16)),f=o(5);t.getMd5=function(e){return new Promise((function(t,o){try{if("string"==typeof e)wx.getFileInfo({filePath:e,digestAlgorithm:"md5",success:function(e){var o=e.digest;t({fileHash:o})},fail:function(e){o(e)}});else{var i=new FileReader;i.onload=function(){var e=i.result||i.content;e?t({fileHash:n.default(a.default.parse(e)).toString(c.default)}):o(f.transError(f.ZegoDocsViewError.ZegoDocsViewErrorFileEmpty))},i.onerror=function(){o(f.transError(f.ZegoDocsViewError.ZegoDocsViewErrorFileNotExist))},i.readAsBinaryString(e)}}catch(e){o(e)}}))};var p=function(e,t){return h.default.stringify(s.default(t,e))};t.getUploadOssInfo=function(e){var t=e.access_key_id,o=e.access_key_secret,i=e.bucket_name,n=e.security_token,s=e.endpoint,a=e.object_name,c=e.timeout,h=void 0===c?1:c,f=e.maxSize,l=function(e,t){var o=new Date;o.setHours(o.getHours()+e);var i={expiration:o.toISOString(),conditions:[["content-length-range",0,1024*t*1024]]};return r.default.Base64.encode(JSON.stringify(i))}(h,void 0===f?150:f);return{url:"https://"+i+"."+s,signature:p(o,l),securityToken:n,policy:l,key:a,OSSAccessKeyId:t,successActionStatus:"200",objectName:a}}},function(e,t,o){(function(o){var i;!function(o,r){e.exports=function(o){"use strict";var r,n=(o=o||{}).Base64,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(e){for(var t={},o=0,i=e.length;o<i;o++)t[e.charAt(o)]=o;return t}(s),c=String.fromCharCode,h=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?c(192|t>>>6)+c(128|63&t):c(224|t>>>12&15)+c(128|t>>>6&63)+c(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return c(240|t>>>18&7)+c(128|t>>>12&63)+c(128|t>>>6&63)+c(128|63&t)},f=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,p=function(e){return e.replace(f,h)},l=function(e){var t=[0,2,1][e.length%3],o=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[s.charAt(o>>>18),s.charAt(o>>>12&63),t>=2?"=":s.charAt(o>>>6&63),t>=1?"=":s.charAt(63&o)].join("")},u=o.btoa&&"function"==typeof o.btoa?function(e){return o.btoa(e)}:function(e){if(e.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return e.replace(/[\s\S]{1,3}/g,l)},d=function(e){return u(p(String(e)))},g=function(e){return e.replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,"")},v=function(e,t){return t?g(d(e)):d(e)};o.Uint8Array&&(r=function(e,t){for(var o="",i=0,r=e.length;i<r;i+=3){var n=e[i],a=e[i+1],c=e[i+2],h=n<<16|a<<8|c;o+=s.charAt(h>>>18)+s.charAt(h>>>12&63)+(void 0!==a?s.charAt(h>>>6&63):"=")+(void 0!==c?s.charAt(63&h):"=")}return t?g(o):o});var m,y=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,w=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return c(55296+(t>>>10))+c(56320+(1023&t));case 3:return c((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return c((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},D=function(e){return e.replace(y,w)},I=function(e){var t=e.length,o=t%4,i=(t>0?a[e.charAt(0)]<<18:0)|(t>1?a[e.charAt(1)]<<12:0)|(t>2?a[e.charAt(2)]<<6:0)|(t>3?a[e.charAt(3)]:0),r=[c(i>>>16),c(i>>>8&255),c(255&i)];return r.length-=[0,0,2,1][o],r.join("")},E=o.atob&&"function"==typeof o.atob?function(e){return o.atob(e)}:function(e){return e.replace(/\S{1,4}/g,I)},T=function(e){return E(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},P=function(e){return String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,"")},S=function(e){return function(e){return D(E(e))}(P(e))};o.Uint8Array&&(m=function(e){return Uint8Array.from(T(P(e)),(function(e){return e.charCodeAt(0)}))});var C=function(){var e=o.Base64;return o.Base64=n,e};if(o.Base64={VERSION:"2.6.4",atob:T,btoa:u,fromBase64:S,toBase64:v,utob:p,encode:v,encodeURI:function(e){return v(e,!0)},btou:D,decode:S,noConflict:C,fromUint8Array:r,toUint8Array:m},"function"==typeof Object.defineProperty){var _=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};o.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",_((function(){return S(this)}))),Object.defineProperty(String.prototype,"toBase64",_((function(e){return v(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",_((function(){return v(this,!0)})))}}o.Meteor&&(Base64=o.Base64);e.exports?e.exports.Base64=o.Base64:void 0===(i=function(){return o.Base64}.apply(t,[]))||(e.exports=i);return{Base64:o.Base64}}(o)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==o?o:this)}).call(this,o(44))},function(e,t){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"==typeof window&&(o=window)}e.exports=o},function(e,t,o){var i;e.exports=(i=o(1),o(18),o(19),i.HmacSHA1)},function(e,t,o){var i;e.exports=(i=o(1),i.enc.Latin1)},,function(e,t,o){var i,r,n,s,a,c,h,f;e.exports=(f=o(1),o(18),o(19),r=(i=f).lib,n=r.Base,s=r.WordArray,a=i.algo,c=a.MD5,h=a.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var o=this.cfg,i=o.hasher.create(),r=s.create(),n=r.words,a=o.keySize,c=o.iterations;n.length<a;){h&&i.update(h);var h=i.update(e).finalize(t);i.reset();for(var f=1;f<c;f++)h=i.finalize(h),i.reset();r.concat(h)}return r.sigBytes=4*a,r}}),i.EvpKDF=function(e,t,o){return h.create(o).compute(e,t)},f.EvpKDF)},function(e,t,o){var i;e.exports=(i=o(1),o(48),void(i.lib.Cipher||function(e){var t=i,o=t.lib,r=o.Base,n=o.WordArray,s=o.BufferedBlockAlgorithm,a=t.enc,c=(a.Utf8,a.Base64),h=t.algo.EvpKDF,f=o.Cipher=s.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,o){this.cfg=this.cfg.extend(o),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?w:m}return function(t){return{encrypt:function(o,i,r){return e(i).encrypt(t,o,i,r)},decrypt:function(o,i,r){return e(i).decrypt(t,o,i,r)}}}}()}),p=(o.StreamCipher=f.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),t.mode={}),l=o.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),u=p.CBC=function(){var e=l.extend();function t(e,t,o){var i=this._iv;if(i){var r=i;this._iv=void 0}else r=this._prevBlock;for(var n=0;n<o;n++)e[t+n]^=r[n]}return e.Encryptor=e.extend({processBlock:function(e,o){var i=this._cipher,r=i.blockSize;t.call(this,e,o,r),i.encryptBlock(e,o),this._prevBlock=e.slice(o,o+r)}}),e.Decryptor=e.extend({processBlock:function(e,o){var i=this._cipher,r=i.blockSize,n=e.slice(o,o+r);i.decryptBlock(e,o),t.call(this,e,o,r),this._prevBlock=n}}),e}(),d=(t.pad={}).Pkcs7={pad:function(e,t){for(var o=4*t,i=o-e.sigBytes%o,r=i<<24|i<<16|i<<8|i,s=[],a=0;a<i;a+=4)s.push(r);var c=n.create(s,i);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g=(o.BlockCipher=f.extend({cfg:f.cfg.extend({mode:u,padding:d}),reset:function(){f.reset.call(this);var e=this.cfg,t=e.iv,o=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=o.createEncryptor;else i=o.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==i?this._mode.init(this,t&&t.words):(this._mode=i.call(o,this,t&&t.words),this._mode.__creator=i)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4}),o.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),v=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,o=e.salt;if(o)var i=n.create([1398893684,1701076831]).concat(o).concat(t);else i=t;return i.toString(c)},parse:function(e){var t=c.parse(e),o=t.words;if(1398893684==o[0]&&1701076831==o[1]){var i=n.create(o.slice(2,4));o.splice(0,4),t.sigBytes-=16}return g.create({ciphertext:t,salt:i})}},m=o.SerializableCipher=r.extend({cfg:r.extend({format:v}),encrypt:function(e,t,o,i){i=this.cfg.extend(i);var r=e.createEncryptor(o,i),n=r.finalize(t),s=r.cfg;return g.create({ciphertext:n,key:o,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,o,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(o,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),y=(t.kdf={}).OpenSSL={execute:function(e,t,o,i){i||(i=n.random(8));var r=h.create({keySize:t+o}).compute(e,i),s=n.create(r.words.slice(t),4*o);return r.sigBytes=4*t,g.create({key:r,iv:s,salt:i})}},w=o.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:y}),encrypt:function(e,t,o,i){var r=(i=this.cfg.extend(i)).kdf.execute(o,e.keySize,e.ivSize);i.iv=r.iv;var n=m.encrypt.call(this,e,t,r.key,i);return n.mixIn(r),n},decrypt:function(e,t,o,i){i=this.cfg.extend(i),t=this._parse(t,i.format);var r=i.kdf.execute(o,e.keySize,e.ivSize,t.salt);return i.iv=r.iv,m.decrypt.call(this,e,t,r.key,i)}})}()))},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressDocs=void 0;var i=o(51),r=function(){function e(e){this.zegoDocsView=new i.ZegoDocsViewManager(e)}return e.prototype.createView=function(e,t,o){return this.zegoDocsView.createView(e,t,o)},e.prototype.uploadFile=function(e,t,o){return this.zegoDocsView.uploadFile(e,t,o)},e.prototype.cancelUpload=function(e){return this.zegoDocsView.cancelUpload(e)},e.prototype.downloadFile=function(e){return this.zegoDocsView.downloadFile(e)},e.prototype.on=function(e,t){return this.zegoDocsView.on(e,t)},e.prototype.off=function(e,t){return this.zegoDocsView.off(e,t)},e.prototype.getVersion=function(){return this.zegoDocsView.getVersion()},e.prototype.setTestEnv=function(e){this.zegoDocsView.setTestEnv(e)},e.prototype.setConfig=function(e,t){return this.zegoDocsView.setConfig(e,t)},e.prototype.getConfig=function(e){return this.zegoDocsView.getConfig(e)},e}();t.ZegoExpressDocs=r},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsViewManager=void 0,o(52),o(23);var i=o(54),r=o(59),n=o(61),s=o(3),a=o(4),c=s.getLogAction.bind(null,"docs.m."),h=function(){function e(e){this.docsviews={};var t={appID:e.appID,userID:e.userID,token:e.token,isTestEnv:!!e.isTestEnv};this.serviceHandle=new n.ZegoDocsViewService(new i.ZegoDocs(t)),this.on("onViewMessage",this.onViewMessage.bind(this)),s.Logger.init({appid:t.appID,isTestEnv:t.isTestEnv,version:this.getVersion(),isProd:!0}),s.Logger.initRoom({roomid:"",userid:t.userID,token:t.token}),s.Logger.info(c("new"),JSON.stringify({params:e}))}return e.prototype.onViewMessage=function(e){var t=e.action,o=e.id,i=e.args;if(t&&o&&i){if("unloadFile"===t)return void delete this.docsviews[o];var r=this.docsviews[o];r&&r[t].apply(r,i)}},e.prototype.createView=function(e,t,o){var i={parent:e,viewID:t=(t||Date.now()+Math.floor(1e3*Math.random()))+"",sheetName:o=o||""},n=c("createView"),h=this.docsviews[t];if(h)return h.setSheetName(o),s.Logger.info(n,JSON.stringify({actionMsg:"find in cache",params:i})),h;var f=document.getElementById(a.DOMIDS.wb+t);if(f=f&&f.parentElement){var p=f.id.replace(a.DOMIDS.doc,"");if(h=this.docsviews[p])return h.setSheetName(o),this.docsviews[t]=h,i.wbID=p,s.Logger.info(n,JSON.stringify({actionMsg:"find in cache on whiteboard",params:i})),h}return(h=new r.ZegoDocsViewImpl(this.serviceHandle,e,t)).setSheetName(o),this.docsviews[t]=h,s.Logger.info(n,JSON.stringify({params:i})),h},e.prototype.uploadFile=function(e,t,o){return this.serviceHandle.upload({file:e,renderType:t,extraInfo:o||{}})},e.prototype.cancelUpload=function(e){return this.serviceHandle.cancelUpload({fileHash:e})},e.prototype.downloadFile=function(e){return this.serviceHandle.download({fileID:e,authKey:""}).then((function(e){var t=window.encodeURI(e.name),o=document.createElement("a");return o.href=e.url+"?name="+t,o.download=t,o.target="_blank",o.style.display="none",o.click(),e}))},e.prototype.on=function(e,t){return this.serviceHandle.addEventListener(e,t)},e.prototype.off=function(e,t){return this.serviceHandle.removeEventListener(e,t)},e.prototype.getVersion=function(){return"1.15.0"},e.prototype.setTestEnv=function(e){this.serviceHandle.setTestEnv(e)},e.prototype.setConfig=function(e,t){return this.serviceHandle.setConfig(e,t)},e.prototype.getConfig=function(e){return this.serviceHandle.getConfig(e)},e}();t.ZegoDocsViewManager=h},function(e,t,o){var i=o(21),r=o(53);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var n={insert:"head",singleton:!1};i(r,n);e.exports=r.locals||{}},function(e,t,o){(t=o(22)(!1)).push([e.i,"[id^='zego-docsview-zoom'],\n[id^='zego-docsview-render'],\n[id^='zego-docsview-render'] > div,\n[id^='zego-docsview-con'],\n[id^='zego-docsview-con'] > div {\n    position: absolute;\n    left: 0;\n    top: 0;\n}\n\n/* [id^='zego-docsview-con'], */\n[id^='zego-docsview-con'] > div,\n[id^='zego-docsview-render'] > div,\n[id^='zego-docsview-iframe'] {\n    transform-origin: 0 0;\n}\n\n[id^='zego-docsview-render'] {\n    text-align: initial;\n}\n\n[id^='zego-docsview-render'] iframe {\n    border: none;\n}\n[id^='zego-docsview-render'] canvas {\n    display: block;\n}\n\n[id^='zego-docsview-zoom'] svg.loading {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    margin: -24px;\n    display: none;\n\tanimation:loading 2s infinite linear;\n\t-webkit-animation:loading 2s infinite linear;\n\t-moz-animation:loading 2s infinite linear;\n\t-o-animation:loading 2s infinite linear;\n}\n@keyframes loading {\n\tfrom {\n        transform:rotate(0deg);\n        -ms-transform:rotate(0deg);\n    }\n    to {\n        transform:rotate(360deg);\n        -ms-transform:rotate(360deg);\n    }\n}\n@-webkit-keyframes loading {\n\tfrom {\n        -webkit-transform:rotate(0deg);\n    }\n    to {\n        -webkit-transform:rotate(360deg);\n    }\n}\n@-moz-keyframes loading {\n\tfrom {\n\t    -moz-transform:rotate(0deg);\n    }\n    to {\n        -moz-transform:rotate(360deg);\n    }\n}\n@-o-keyframes loading {\n\tfrom {\n\t    -o-transform:rotate(0deg);\n    }\n    to {\n        -o-transform:rotate(360deg);\n    }\n}\n",""]),e.exports=t},function(e,t,o){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(r,n){function s(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var o,i,r,n,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(r=2&n[0]?i.return:n[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){s.label=n[1];break}if(6===n[0]&&s.label<r[1]){s.label=r[1],r=n;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(n);break}r[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocs=void 0;var a=s(o(24)),c=o(55),h=o(42),f=o(56),p=o(5),l=function(){function e(e){this.axiosInstance=a.default.create({timeout:p.HTTP_TIME}),this.stateCenter={appID:0,platform:32,webToken:"",userID:"",cancelMap:{}},this.init(e)}return e.prototype.init=function(e){var t=e.token,o=e.appID,i=e.userID,r=e.isTestEnv;this.stateCenter.appID=o,this.stateCenter.webToken=t,this.stateCenter.userID=i,this.config={testDomain:"https://docservice-test.zego.im",domain:f.isPrivateServer?"":"https://docservice.zego.im",testEnv:!1,dynamicPPT_HD:!1},this.setTestEnv(!!r)},e.prototype.setTestEnv=function(e){"boolean"==typeof e&&(this.config.testEnv=!!e);var t=this.config.testEnv?this.config.testDomain:this.config.domain;this.requestUrls={queryStatusUrl:t+"/doc/query_status",createCvtUrl:t+"/doc/cvt_doc",cancelCvtUrl:t+"/doc/cancel_cvt",queryUrl:t+"/doc/access"}},e.prototype.setConfig=function(e,t){return!(!e||void 0===t)&&(this.config[e]=t,e===p.ZegoConfigKey.Domain&&this.setTestEnv(),!0)},e.prototype.getConfig=function(e){return this.config[e]},e.prototype.upload=function(e){return!e.file||"number"!=typeof e.renderType||isNaN(e.renderType)?Promise.reject(p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorParamInvalid)):this.config.testEnv||this.config.domain||!f.isPrivateServer?this.uploadProgress(e):Promise.reject(p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorEmptyDomain))},e.prototype.load=function(e){var t=this;if(!this.config.testEnv&&!this.config.domain&&f.isPrivateServer)return Promise.reject(p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorEmptyDomain));if(!e.fileID)return Promise.reject(p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorParamInvalid));var o={platform:this.stateCenter.platform,app_id:this.stateCenter.appID,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID,file_id:e.fileID};return new Promise((function(i,s){return r(t,void 0,void 0,(function(){var t,r,a,c,h;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.queryUrl,method:"post",timeout:e.timeout||p.HTTP_TIME,data:o})];case 1:return t=n.sent(),0===(r=t.data).ret.code?(r.file_urls=r.file_urls||[],a={pageCount:r.page_count||r.file_urls.length||1,notes:r.notes||[""],fileUrls:r.file_urls,fileSize:r.file_size,fileHash:r.file_hash},16===r.file_type&&(c=r.file_name.substr(r.file_name.lastIndexOf(".")),a.fileUrls=r.original_file_urls.map((function(e){return e+"?"+c}))),f.handleFileOfView(o.file_id,r,a),i(a)):s(p.transError(r.ret.code,r.ret.message)),[3,3];case 2:return h=n.sent(),s(h),[3,3];case 3:return[2]}}))}))}))},e.prototype.download=function(e){var t=this;if(!this.config.testEnv&&!this.config.domain&&f.isPrivateServer)return Promise.reject(p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorEmptyDomain));if(!e.fileID)return Promise.reject(p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorParamInvalid));var o={platform:this.stateCenter.platform,app_id:this.stateCenter.appID,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID,file_id:e.fileID};return new Promise((function(i,s){return r(t,void 0,void 0,(function(){var t,r,a;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.queryUrl,method:"post",timeout:e.timeout||p.HTTP_TIME,data:o})];case 1:return t=n.sent(),0===(r=t.data).ret.code?i({url:r.original_file_urls[0],name:r.file_name}):s(p.transError(r.ret.code,r.ret.message)),[3,3];case 2:return a=n.sent(),s(a),[3,3];case 3:return[2]}}))}))}))},e.prototype.cancelUpload=function(e){var t=this,o=e.fileHash,s=e.taskID;if(!s)return new Promise((function(e,r){t.stateCenter.cancelMap[o]=!0,e(i(i({},p.transError(p.ZegoDocsViewError.ZegoDocsViewSuccess)),{fileHash:o}))}));var a={app_id:this.stateCenter.appID,platform:this.stateCenter.platform,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID,task_id:s};return new Promise((function(e,c){return r(t,void 0,void 0,(function(){var t,r,h;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.cancelCvtUrl,method:"post",timeout:p.HTTP_TIME,data:a})];case 1:return t=n.sent(),0===(r=t.data).ret.code?(this.stateCenter.cancelMap[o]=s,e(i(i({},p.transError(p.ZegoDocsViewError.ZegoDocsViewSuccess)),{fileHash:o,taskID:s}))):c(p.transError(r.ret.code,r.ret.message)),[3,3];case 2:return h=n.sent(),c(h),[3,3];case 3:return[2]}}))}))}))},e.prototype.uploadSucceedAfter=function(e){var t=e.uploadResult,o=e.onProgress,i=e.originReslove,r=e.resolve;o&&o(t),i?i(t):r(t)},e.prototype.uploadProgressInit=function(e){return r(this,void 0,void 0,(function(){var t,o,i,r,s,a,c,h,f;return n(this,(function(n){switch(n.label){case 0:return t=e.statusInitSub,o=e.file,i=e.fileName,r=e.onProgress,a=(s=t).oss,c=s.fileServerProvider,h=s.fileHash,f=s.sfs,this.stateCenter.cancelMap[h]?(r&&r({status:p.ZegoDocsViewUploadState.CONVERT_CANCEL,fileName:i,fileHash:h}),this.stateCenter.cancelMap[h]=!1,[2,!1]):[4,this.uploadDoc({file:o,fileServerProvider:c,oss:a,sfs:f,fileHash:h,fileName:i,onProgress:r})];case 1:return n.sent(),r&&r({status:p.ZegoDocsViewUploadState.UPLOADED,fileName:i,fileHash:h}),[4,this.uploadProgressCvt(e)];case 2:return n.sent(),[2,!0]}}))}))},e.prototype.uploadProgressCvt=function(e){return r(this,void 0,void 0,(function(){var t,o,i,r,s,a,c,h,l,u,d,g,v,m,y;return n(this,(function(n){switch(n.label){case 0:return t=e.file,o=e.onProgress,i=e.fileType,r=e.fileHash,s=e.fileName,a=e.originReslove,c=e.resolve,h=e.expectFileType,l=e.originReject,u=e.reject,d=this.stateCenter.cancelMap[r],o&&o({status:d?p.ZegoDocsViewUploadState.CONVERT_CANCEL:p.ZegoDocsViewUploadState.UPLOADED,fileName:s,fileHash:r}),d?(this.stateCenter.cancelMap[r]=!1,[2,!1]):(v=this.createCvtDoc,m={},[4,f.getFileSize(t)]);case 1:return[4,v.apply(this,[(m.fileSize=n.sent().fileSize,m.fileName=f.getFileName(t),m.fileType=i,m.fileHash=r,m.expectFileType=h,m)])];case 2:return g=n.sent(),y={fileName:s,fileHash:r,taskID:g.taskID,onProgress:o},[4,this.uploadProgress(y,a||c,l||u)];case 3:return n.sent(),[2,!0]}}))}))},e.prototype.checkSizeHandle=function(e,t){var o=!0;switch(e){case p.ZegoDocsViewFileType.ZegoDocsViewFileTypePPT:case p.ZegoDocsViewFileType.ZegoDocsViewFileTypeDOC:case p.ZegoDocsViewFileType.ZegoDocsViewFileTypePDF:case p.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG:t>104857600&&(o=!1);break;case p.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS:t>10485760&&(o=!1);break;case p.ZegoDocsViewFileType.ZegoDocsViewFileTypeTXT:t>2097152&&(o=!1)}return o},e.prototype.uploadProgress=function(e,t,o){var s=this;return new Promise((function(a,c){return r(s,void 0,void 0,(function(){var s,l,u,d,g,v,m,y,w,D,I,E,T,P,S,C,_,x=this;return n(this,(function(b){switch(b.label){case 0:s="",l="",u=p.ZegoDocsViewFileType.ZegoDocsViewFileTypeUnknown,b.label=1;case 1:return b.trys.push([1,19,,20]),g=(d=e).file,v=d.renderType,m=d.onProgress,y=void 0,w=p.ExpectFileType.PDF,g?(l="string"==typeof g?"":g.name,u=f.getFileType(g),p.ZegoDocsViewRenderType[v]?(w=f.getExpectFileType(v,u),u===p.ZegoDocsViewFileType.ZegoDocsViewFileTypeUnknown?(c(p.transError(60015)),[2]):[4,h.getMd5(g)]):(c(p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorUnsupportRenderType)),[2])):[3,4];case 2:return s=b.sent().fileHash,[4,this.queryStatus({fileHash:s,fileType:u,expectFileType:w})];case 3:return y=b.sent(),[3,6];case 4:return l=(D=e).fileName,s=D.fileHash,[4,this.queryStatus({taskID:D.taskID})];case 5:y=b.sent(),b.label=6;case 6:switch(I=y.status,I){case p.ZegoDocsViewUploadState.UPLOADING:return[3,7];case p.ZegoDocsViewUploadState.UPLOADED:return[3,10];case p.ZegoDocsViewUploadState.WAITING:case p.ZegoDocsViewUploadState.CONVERTING:return[3,12];case p.ZegoDocsViewUploadState.CONVERTED:return[3,16]}return[3,17];case 7:return u=f.getFileType(g),[4,f.getFileSize(g)];case 8:return E=b.sent().fileSize,this.checkSizeHandle(u,E)?[4,this.uploadProgressInit({file:g,expectFileType:w,fileType:u,fileHash:s,fileName:l,statusInitSub:y,onProgress:e.onProgress,originReslove:t,resolve:a,originReject:o,reject:c})]:(T=p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorFileSizeLimit),m&&m(i({fileName:l,fileHash:s},T)),[2,c(T)]);case 9:return b.sent(),[3,18];case 10:return[4,this.uploadProgressCvt({file:g,expectFileType:w,fileType:u,fileHash:s,fileName:l,onProgress:e.onProgress,originReslove:t,resolve:a,originReject:o,reject:c})];case 11:return b.sent(),[3,18];case 12:return P=this.stateCenter.cancelMap[s],S=y.taskID,e.onProgress&&e.onProgress({status:P?p.ZegoDocsViewUploadState.CONVERT_CANCEL:I,fileName:l,fileHash:s,taskID:S}),P?(this.stateCenter.cancelMap[s]=!1,[4,this.cancelUpload({fileHash:s,taskID:S})]):[3,14];case 13:return b.sent(),[3,15];case 14:setTimeout((function(){return r(x,void 0,void 0,(function(){return n(this,(function(i){switch(i.label){case 0:return[4,this.uploadProgress({taskID:S,fileName:l,fileHash:s,onProgress:e.onProgress},t||a,o||c)];case 1:return i.sent(),[2]}}))}))}),2e3),b.label=15;case 15:return[3,18];case 16:return this.uploadSucceedAfter({uploadResult:{status:y.status,fileID:y.fileID,fileName:l,fileHash:s},onProgress:e.onProgress,originReslove:t,resolve:a}),[3,18];case 17:return C=p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorConvertFail),e.onProgress&&e.onProgress(i({status:I,fileName:l,fileHash:s,taskID:S},C)),(o||c)(C),[3,18];case 18:return[3,20];case 19:return _=b.sent(),e.onProgress&&e.onProgress(i(i({fileName:l,fileHash:s},p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorUploadFailed)),{error:_})),o?o(_):c(_),[3,20];case 20:return[2]}}))}))}))},e.prototype.requestHandle=function(e){var t=this;return"wx"===f.getEnv()?new Promise((function(o,s){return r(t,void 0,void 0,(function(){return n(this,(function(t){return wx.request(i(i({},e),{success:function(e){o(e)},fail:function(e){s(e)}})),[2]}))}))})):this.axiosInstance(e)},e.prototype.queryStatus=function(e){var t=this,o={app_id:this.stateCenter.appID,platform:this.stateCenter.platform,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID};if(e.taskID)o.task_id=e.taskID;else{var i=e,s=i.fileHash,a=i.fileType,c=i.expectFileType;o.file_hash=s,o.file_type=a,o.expect_file_type=c}return new Promise((function(i,s){return r(t,void 0,void 0,(function(){var t,r,a,c,h,f,l,u,d,g,v,m,y;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.queryStatusUrl,method:"post",timeout:e.timeout||p.HTTP_TIME,data:o})];case 1:if(t=n.sent(),r=t.data,a=r.ret,c=r.file_type,h=r.status,f=r.file_hash,l=r.file_server_provider,u=r.oss,d=r.sfs,g=r.task_id,v=r.query_interval,m=r.file_id,0===a.code)switch(h){case 32:case 64:case 128:case 256:case 512:case 1024:s(p.transError(h));break;case 1:i({fileType:c,status:h,fileHash:f,fileServerProvider:l,oss:u,sfs:d});break;case 2:i({fileType:c,status:h,fileHash:f});break;case 4:i({fileType:c,status:h,taskID:g,queryInterval:v||1e3});break;case 8:i({fileType:c,status:h,taskID:g});break;case 16:i({fileID:m,status:h});break;default:s(p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorConvertFail))}else s(p.transError(r.ret.code,r.ret.message));return[3,3];case 2:return y=n.sent(),s(y),[3,3];case 3:return[2]}}))}))}))},e.prototype.uploadDocToOssByWx=function(e){var t=this,o=e.oss,i=e.file,r=e.onProgress,n=e.fileName,s=e.fileHash,a=h.getUploadOssInfo(o);return new Promise((function(e,o){try{wx.uploadFile({url:a.url,filePath:i,name:"file",formData:{key:a.objectName,policy:a.policy,OSSAccessKeyId:a.OSSAccessKeyId,success_action_status:a.successActionStatus,signature:a.signature,"x-oss-security-token":a.securityToken},timeout:p.UPLOAD_HTTP_TIME,success:function(t){e(t)},fail:function(e){o(e)}}).onProgressUpdate((function(e){if(!t.stateCenter.cancelMap[s]){var o=e.progress,i=e.totalBytesSent,a=e.totalBytesExpectedToSend;r&&r({status:p.ZegoDocsViewUploadState.UPLOADING,fileName:n,fileHash:s,uploadPercent:o,loaded:i,total:a})}}))}catch(e){o(e)}}))},e.prototype.uploadDocToOssByWeb=function(e){var t=this,o=e.oss,i=e.file,r=e.onProgress,n=e.fileName,s=e.fileHash,a=h.getUploadOssInfo(o),c=new FormData;return c.append("OSSAccessKeyId",a.OSSAccessKeyId),c.append("x-oss-security-token",a.securityToken),c.append("signature",a.signature),c.append("policy",a.policy),c.append("successActionStatus",a.successActionStatus),c.append("key",a.objectName),c.append("file",i),c.append("name",i.name),this.axiosInstance({method:"post",url:a.url,data:c,timeout:p.UPLOAD_HTTP_TIME,onUploadProgress:function(e){if(!t.stateCenter.cancelMap[s]){var o=e.total,i=e.loaded;r&&r({status:p.ZegoDocsViewUploadState.UPLOADING,fileName:n,fileHash:s,uploadPercent:Math.floor(i/o*100),total:o,loaded:i})}}})},e.prototype.uploadDoc=function(e){var t=e.fileServerProvider;return"oss"===t?"wx"===f.getEnv()?this.uploadDocToOssByWx(e):this.uploadDocToOssByWeb(e):"sfs"===t?"wx"===f.getEnv()?c.uploadDocToSfsByWx(this,e):c.uploadDocToSfsByWeb(this,e):Promise.reject(p.transError(p.ZegoDocsViewError.ZegoDocsViewErrorParamInvalid))},e.prototype.getCvtState=function(){var e=this.config.dynamicPPT_HD;return"boolean"==typeof e?e:"true"===e},e.prototype.createCvtDoc=function(e){var t=this,o=e.timeout,i=e.srcFileUrl,s=e.fileName,a=e.fileHash,c=e.fileSize,h=e.fileType,f=e.expectFileType,l={platform:this.stateCenter.platform,app_id:this.stateCenter.appID,web_token:this.stateCenter.webToken,id_name:this.stateCenter.userID,file_name:s,file_hash:a,file_size:c,file_type:h,expect_file_type:f,export_high_quality_images:this.getCvtState()};return i&&(l.src_file_url=i),new Promise((function(e,i){return r(t,void 0,void 0,(function(){var t,r,s;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.requestHandle({url:this.requestUrls.createCvtUrl,method:"post",timeout:o||p.HTTP_TIME,data:l})];case 1:return t=n.sent(),r=t.data,0===r.ret.code?e({status:r.status,taskID:r.task_id}):i(p.transError(r.ret.code,r.ret.message)),[3,3];case 2:return s=n.sent(),i(s),[3,3];case 3:return[2]}}))}))}))},e}();t.ZegoDocs=l},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadDocToSfsByWeb=t.uploadDocToSfsByWx=void 0;var i=o(5);t.uploadDocToSfsByWx=function(e,t){var o=t.sfs,r=t.fileHash,n=t.file,s=t.onProgress,a=t.fileName,c=o,h=c.token,f=c.expired_timestamp,p=c.api,l=c.object_name,u={app_id:e.stateCenter.appID,platform:e.stateCenter.platform,user_id:e.stateCenter.userID,expired_timestamp:f,sfs_token:h,file_name:l,file_hash:r},d=new FormData;return d.append("req",new Blob([JSON.stringify(u)],{type:"application/json"})),d.append("document",n),new Promise((function(e,t){try{wx.uploadFile({url:p,filePath:n,name:"file",formData:d,timeout:6e5,success:function(t){e()},fail:function(e){t(e)}}).onProgressUpdate((function(e){var t=e.progress,o=e.totalBytesSent,n=e.totalBytesExpectedToSend;s&&s({status:i.ZegoDocsViewUploadState.UPLOADING,fileName:a,fileHash:r,uploadPercent:t,loaded:o,total:n})}))}catch(e){t(e)}}))},t.uploadDocToSfsByWeb=function(e,t){var o=t.sfs,r=t.fileHash,n=t.file,s=t.onProgress,a=t.fileName,c=o,h=c.token,f=c.expired_timestamp,p=c.api,l=c.object_name,u={app_id:e.stateCenter.appID,platform:e.stateCenter.platform,user_id:e.stateCenter.userID,expired_timestamp:f,sfs_token:h,file_name:l,file_hash:r},d=new FormData;return d.append("req",new Blob([JSON.stringify(u)],{type:"application/json"})),d.append("document",n),e.axiosInstance({method:"post",url:p,data:d,timeout:6e5,onUploadProgress:function(e){var t=e.total,o=e.loaded;s&&s({status:i.ZegoDocsViewUploadState.UPLOADING,fileName:a,fileHash:r,uploadPercent:Math.floor(o/t*100),total:t,loaded:o})}})}},function(e,t,o){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleFileOfView=t.decryptU8arry=t.refreshCDNHandle=t.getExpectFileType=t.getFileName=t.getFileSize=t.getFileType=t.getEnv=t.isPrivateServer=void 0;var r=i(o(57)),n=i(o(20)),s=i(o(16)),a=i(o(58)),c=i(o(1)),h=o(5),f=n.default.parse("89c78c018ed563571a3024342073c002"),p=n.default.parse("0d9d89c53bd0a086834b411fe8387946");t.isPrivateServer=!1;var l="";t.getEnv=function(){return l||(l="undefined"!=typeof wx&&"function"==typeof wx.canIUse?"wx":"web"),l},t.getFileType=function(e){var t=h.ZegoDocsViewFileType.ZegoDocsViewFileTypeUnknown,o=("string"==typeof e?e:e.name).split(".").pop();switch(o?o.toUpperCase():o){case"XLSX":case"XLS":t=h.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS;break;case"DOC":case"DOCX":t=h.ZegoDocsViewFileType.ZegoDocsViewFileTypeDOC;break;case"PPT":case"PPTX":t=h.ZegoDocsViewFileType.ZegoDocsViewFileTypePPT;break;case"TXT":case"MD":case"C":case"CPP":case"H":case"HPP":case"PY":case"JS":case"XML":t=h.ZegoDocsViewFileType.ZegoDocsViewFileTypeTXT;break;case"PDF":t=h.ZegoDocsViewFileType.ZegoDocsViewFileTypePDF;break;case"JPG":case"JPEG":case"PNG":case"BMP":case"SVG":case"HEIC":t=h.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG}return t},t.getFileSize=function(e){return new Promise((function(t,o){try{"string"==typeof e?wx.getFileInfo({filePath:e,digestAlgorithm:"md5",success:function(e){var o=e.size;t({fileSize:o})},fail:function(e){o(e)}}):t({fileSize:e.size})}catch(e){o(e)}}))},t.getFileName=function(e){return"string"==typeof e?e.split("wxfile://")[1]||e.split("http://")[1]||e.split("https://")[1]:e.name},t.getExpectFileType=function(e,t){var o;switch(e){case h.ZegoDocsViewRenderType.ZegoDocsViewRenderTypeVector:o=h.ExpectFileType.PDF;break;case h.ZegoDocsViewRenderType.ZegoDocsViewRenderTypeIMG:o=h.ExpectFileType.IMG;break;case h.ZegoDocsViewRenderType.ZegoDocsViewRenderTypeVectorAndIMG:o=t===h.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG?h.ExpectFileType.IMG:h.ExpectFileType.IMGAndPDF;break;case h.ZegoDocsViewRenderType.ZegoDocsViewRenderTypeDynamicPPTH5:o=h.ExpectFileType.PPTH5;break;default:o=h.ExpectFileType.IMGAndPDF}return o},t.refreshCDNHandle=function(e){};t.decryptU8arry=function(e){var t=function(e){for(var t=e.length,o=[],i=0;i<t;i++)o[i>>>2]|=(255&e[i])<<24-i%4*8;return c.default.lib.WordArray.create(o,t)}(e).toString(s.default);return function(e){for(var t=e.words,o=e.sigBytes,i=new Uint8Array(o),r=0;r<o;r++){var n=t[r>>>2]>>>24-r%4*8&255;i[r]=n}return i}(r.default.decrypt(t,f,{iv:p,mode:c.default.mode.CBC,padding:a.default}))},t.handleFileOfView=function(e,t,o){var i=h.ZegoDocsViewFileType.ZegoDocsViewFileTypeDynamicPPTH5,r=t.file_type,n=t.expect_file_type,s=t.file_name,a=t.width,c=t.height,f=t.split_file_list,p=t.file_urls,l=n===i?i:r,u=l===h.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS;if(Object.assign(o,{fileID:e,fileName:s,fileType:l,width:a,height:c,thumbnails:t.thumbnails||[],cdn_hosts:t.cdn_hosts||[]}),f){var d=1,g=[];o.file_list=f.map((function(e){var t={};if(u){var o=Math.floor(e.width),i=Math.floor(e.height);t.name=s,t.file_name=e.file_name.replace(/\.[a-zA-Z]+$/,""),t.page_list=e.file_urls.map((function(e,t){return g.push(e),{width:o,height:i,src:e,virtual_page_list:[{width:o,height:i,virtual_page_number:t+d}]}})),d+=e.file_urls.length}else{var r=0,n=[];e.split_data.forEach((function(e){e.page_data.forEach((function(e){for(var t=Math.floor(e[0]),o=Math.floor(e[1]),i=e[3],s=0;s<i;s++)n.push({width:t,height:o,src:p[r++],virtual_page_list:[{width:t,height:o,virtual_page_number:r}]})}))})),t.file_name=s,t.page_list=n}return t})),u&&(o.fileUrls=g,o.pageCount=g.length)}else o.file_list=[{file_name:s,page_list:o.fileUrls.map((function(e,t){return{width:a,height:c,src:e,virtual_page_list:[{width:a,height:c,virtual_page_number:t+1}]}}))}]}},function(e,t,o){var i;e.exports=(i=o(1),o(16),o(17),o(48),o(49),function(){var e=i,t=e.lib.BlockCipher,o=e.algo,r=[],n=[],s=[],a=[],c=[],h=[],f=[],p=[],l=[],u=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var o=0,i=0;for(t=0;t<256;t++){var d=i^i<<1^i<<2^i<<3^i<<4;d=d>>>8^255&d^99,r[o]=d,n[d]=o;var g=e[o],v=e[g],m=e[v],y=257*e[d]^16843008*d;s[o]=y<<24|y>>>8,a[o]=y<<16|y>>>16,c[o]=y<<8|y>>>24,h[o]=y,y=16843009*m^65537*v^257*g^16843008*o,f[d]=y<<24|y>>>8,p[d]=y<<16|y>>>16,l[d]=y<<8|y>>>24,u[d]=y,o?(o=g^e[e[e[m^g]]],i^=e[e[i]]):o=i=1}}();var d=[0,1,2,4,8,16,32,64,128,27,54],g=o.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,o=e.sigBytes/4,i=4*((this._nRounds=o+6)+1),n=this._keySchedule=[],s=0;s<i;s++)if(s<o)n[s]=t[s];else{var a=n[s-1];s%o?o>6&&s%o==4&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=d[s/o|0]<<24),n[s]=n[s-o]^a}for(var c=this._invKeySchedule=[],h=0;h<i;h++)s=i-h,a=h%4?n[s]:n[s-4],c[h]=h<4||s<=4?a:f[r[a>>>24]]^p[r[a>>>16&255]]^l[r[a>>>8&255]]^u[r[255&a]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,a,c,h,r)},decryptBlock:function(e,t){var o=e[t+1];e[t+1]=e[t+3],e[t+3]=o,this._doCryptBlock(e,t,this._invKeySchedule,f,p,l,u,n),o=e[t+1],e[t+1]=e[t+3],e[t+3]=o},_doCryptBlock:function(e,t,o,i,r,n,s,a){for(var c=this._nRounds,h=e[t]^o[0],f=e[t+1]^o[1],p=e[t+2]^o[2],l=e[t+3]^o[3],u=4,d=1;d<c;d++){var g=i[h>>>24]^r[f>>>16&255]^n[p>>>8&255]^s[255&l]^o[u++],v=i[f>>>24]^r[p>>>16&255]^n[l>>>8&255]^s[255&h]^o[u++],m=i[p>>>24]^r[l>>>16&255]^n[h>>>8&255]^s[255&f]^o[u++],y=i[l>>>24]^r[h>>>16&255]^n[f>>>8&255]^s[255&p]^o[u++];h=g,f=v,p=m,l=y}g=(a[h>>>24]<<24|a[f>>>16&255]<<16|a[p>>>8&255]<<8|a[255&l])^o[u++],v=(a[f>>>24]<<24|a[p>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^o[u++],m=(a[p>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&f])^o[u++],y=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[f>>>8&255]<<8|a[255&p])^o[u++],e[t]=g,e[t+1]=v,e[t+2]=m,e[t+3]=y},keySize:8});e.AES=t._createHelper(g)}(),i.AES)},function(e,t,o){var i;e.exports=(i=o(1),o(49),i.pad.NoPadding={pad:function(){},unpad:function(){}},i.pad.NoPadding)},function(e,t,o){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<o;t++)for(var n=arguments[t],s=0,a=n.length;s<a;s++,r++)i[r]=n[s];return i};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsViewImpl=void 0;var n=o(60),s=o(4),a=o(3),c=a.getLogAction.bind(null,"docs.v."),h=function(){function e(e,t,o){var i=this;this.parent="",this.id="",this.wbId="",this.canvasArray=[],this.renderMode=s.RenderMode.PDF,this.isTouch="ontouchstart"in document.body,this.viewInfo={ticking:!1,percent:0,total:1,sheet:0,sheetName:"",parentWidth:0,parentHeight:0,width:0,height:0,viewWidth:0,viewHeight:0,rate:1,canvasMaxPage:5,canvasRatio:window.devicePixelRatio||1,scrollTop:0,scrollLeft:0,lastTime:0,lastTimeId:0,isParentScale:!1,h5CDNUsedMap:{},firstInfo:{page:0,step:0,h5Extra:""}},this.zoomInfo={zoom:1,x:0,y:0,tx:0,ty:0,draging:!1,scrollChanged:!1,drag:!1,enable:!0},this.ppth5Info={page:1,step:1,scene:0,targetPage:0,targetStep:0,lastStep:-1,goPage:0,goStep:0,notify:!1,loaded:!1,scale:1,goTimer:0,syncTimer:0,pageChangeTimer:0,p:""},this.fileInfo={},this.vpageImgCache={},this.vpageAspecCache={},this.vpageDrawCache={},this.domEventListeners=null,this.ifCanvasLoadedScrollTop=0,this.onLoadFileCallback=function(){var e,t=i.viewInfo,o=t.width,r=t.height,n=i.getFile(),a=i.getFileType(),c={parent:i.parent,fileID:i.fileInfo.user_data,fileName:n.file_name,fileType:a,pageCount:n.page_count,width:o,height:r,viewID:s.DOMIDS.doc+i.id},h=((e={fileID:c.fileID})[c.fileName]={width:o,height:r,pageCount:c.pageCount},e);a===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS&&(c.name=n.name,c.sheets=i.fileInfo.file_list.map((function(e){return h[e.file_name]={width:e.max_width,height:e.total_height,pageCount:e.page_count},e.file_name}))),document.body.dispatchEvent(new CustomEvent("loadfile",{detail:h})),i.serviceHandle.triggerEventListener("onLoadFile",c)},this.handleDragStart=function(e){if(i.zoomInfo.x=i.zoomInfo.y=0,i.zoomInfo.drag){var t=e instanceof TouchEvent?e.changedTouches[0]:e,o=t.clientX,r=t.clientY;if(i.renderMode===s.RenderMode.PDF){var n=i.docDom.getBoundingClientRect(),a=n.bottom;if(o>n.right-15||r>a-15)return;i.zoomInfo.tx=i.docDom.scrollLeft,i.zoomInfo.ty=i.docDom.scrollTop}(i.zoomInfo.zoom>1||i.viewInfo.height>i.viewInfo.viewHeight)&&(i.zoomInfo.x=o,i.zoomInfo.y=r)}},this.handleDragEvent=function(e,t){i.zoomInfo.drag&&i.zoomInfo.x&&(t||!i.viewInfo.ticking)&&(requestAnimationFrame((function(){e instanceof MouseEvent&&!t&&e.buttons<1?i.viewInfo.ticking=!1:i.renderMode===s.RenderMode.PDF?i.dragPDF(e,!!t):(i.dragPPT(e,!!t),i.viewInfo.ticking=!1)})),i.viewInfo.ticking=!0)},this.serviceHandle=e,this.init(t,o)}return e.prototype.setParentWidthHeight=function(e){var t=document.getElementById(e),o=t.clientWidth,i=t.clientHeight;this.viewInfo.parentWidth=o,this.viewInfo.parentHeight=i},e.prototype.setDocsViewDomOverflow=function(){var e=this.zoomInfo,t=e.zoom,o=e.enable;if(t>1){var i=this.renderMode===s.RenderMode.PDF&&o?"auto":"hidden";this.docDom.style.overflowX=i,this.docDom.style.overflowY=i,this.renderDom&&(this.renderDom.style.overflowX=i,this.renderDom.style.overflowY=i)}else{var r=this.viewInfo,n=r.height,a=r.viewHeight;i=(this.renderMode===s.RenderMode.PDF?n:this.vpageAspecCache[0][1].h)>a&&o?" auto":"hidden";this.docDom.style.overflowX="hidden",this.docDom.style.overflowY=i,this.renderDom&&(this.renderDom.style.overflowX="hidden",this.renderDom.style.overflowY=i)}},e.prototype.setDocsViewDomTransform=function(e,t){var o=function(e,t,o){return"transform:translate("+e+"px,"+t+"px) scale("+o+");"},i=this.zoomInfo.zoom,r=t-(this.ppth5Info.page-1)*this.viewInfo.viewHeight*i,n=this.renderDom.firstChild;n.style.cssText+=o(e,t,this.renderMode===s.RenderMode.PPT?1:i),(n=this.getDocViewChild()).style.cssText+=o(e,r,i)},e.prototype.getCanvasSplit=function(e){var t=this.viewInfo,o=t.canvasMaxPage,i=t.total,r=(e-1)/o|0;return{index:r,start:r*o+1,end:Math.min(r*o+o,i)}},e.prototype.getCanvasHeight=function(e){var t=this.viewInfo,o=t.sheet,i=t.total,r=t.height,n=t.viewHeight,a=t.canvasMaxPage,c=this.vpageAspecCache[o],h=c.h[e]||0;if(h)return h;if(this.getFileType()===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG)return h=r,c.h[e]=h,h;if(this.renderMode===s.RenderMode.PPT)return h=n,c.h[e]=h,h;for(var f=e?c.p[e*a]+1:c.vs,p=c.p[Math.min((e+1)*a,i)],l=f;l<=p;l++)h+=c[l].h;return h=Math.round(h),c.h[e]=h,h},e.prototype.getImgErrorAspec=function(e,t,o){var i=128*this.zoomInfo.zoom*this.viewInfo.canvasRatio;return[(e-i)/2,o+=(t-i)/2,i,i]},e.prototype.clearImgError=function(e,t,o,i){e.clearRect.apply(e,this.getImgErrorAspec(t,o,i))},e.prototype.drawImgError=function(e,t,o,i,s){e.drawImage.apply(e,r([n.IMG_ERROR],this.getImgErrorAspec(t,o,i))),a.Logger.info(c("draw_error"),JSON.stringify({p:this.ppth5Info.page,vpage:s}))},e.prototype.drawDividingLine=function(e,t,o){e.lineWidth=1,e.beginPath(),e.moveTo(0,t),e.lineTo(o,t),e.stroke()},e.prototype.getCurrentCDNHost=function(e){return/https?:\/\//.test(e)?e.substr(0,e.indexOf(".zego.im")+8):""},e.prototype.changeImageCDNHost=function(e,t,o,i){var r=this.getCurrentCDNHost(e.src),n=this.getCDNHostList();if(r&&n.length){t[r]=1;var s=(n.findIndex((function(e){return e===r}))+1)%n.length;if(!t[n[s]])return e.src=e.src.replace(r,n[s])+(i?"?p="+i:""),a.Logger.info(c("draw_"+o+"_cdn"),{src:e.src,page:i}),!0}var h={src:e.src,page:i,action:"ImageLoadError"};return this.postErrorMessage(h),a.Logger.info(c("draw_"+o+"_error"),JSON.stringify(h)),!1},e.prototype.changeH5CDNHost=function(){var e=this.viewInfo.h5CDNUsedMap,t=this.iframeDom.src,o=this.getCurrentCDNHost(t),i=this.getCDNHostList();if(o&&i.length){e[o]=1;var r=(i.findIndex((function(e){return e===o}))+1)%i.length;if(!e[i[r]])return this.iframeDom.src=t.replace(o,i[r]),a.Logger.info(c("draw_h5_cdn"),JSON.stringify({src:this.iframeDom.src})),!0}var n={src:t,action:"H5LoadError"};return this.postErrorMessage(n),a.Logger.info(c("draw_h5_error"),JSON.stringify(n)),!1},e.prototype.drawPPT=function(e,t,o,i,r){var n=this;return new Promise((function(s,h){var f=n.viewInfo.canvasRatio;t*=f,o*=f;var p={},l=r.getContext("2d"),u=new Image;u.onload=n.delayDraw((function(){l.clearRect(0,0,t,o),l.fillStyle="white",l.fillRect(0,0,t,o),l.drawImage(u,0,0,t,o),a.Logger.info(c("draw_ppt"),JSON.stringify({p:n.ppth5Info.page,vpage:e,w:t,h:o})),s()})),u.onerror=function(i){n.changeImageCDNHost(u,p,"ppt",e)||(l.clearRect(0,0,t,o),n.drawImgError(l,t,o,0,e),h(i))},u.src=n.getCurrentCDNHost(i)?i+"?p="+e:"data:image/png;base64,"+i}))},e.prototype.drawPDF=function(e,t,o,i,r,n){var s=this;if(this.vpageDrawCache[t])return Promise.resolve();var a=this.getCanvasSplit(e),c=a.index,h=a.start,f=a.end;if(!(e>=h&&e<=f))return Promise.resolve();var p=this.viewInfo,l=p.canvasRatio,u=p.sheet;o*=l,i*=l,r*=l;var d=this.vpageAspecCache[u],g=this.canvasArray[c].getContext("2d");return t-=d.vs-1,new Promise((function(a,c){var h={},f=new Image;f.onload=s.delayDraw((function(){s.clearImgError(g,i,r,o),g.fillStyle="white",g.fillRect(0,o,i,r),g.drawImage(f,0,o,i,r),s.vpageDrawCache[t]=1,t>1&&t===d.p[e-1]+1&&s.drawDividingLine(g,o,i),a()})),f.onerror=function(n){s.changeImageCDNHost(f,h,"pdf",t)||(s.drawImgError(g,i,r,o,t),s.vpageDrawCache[t]=0,t>1&&t===d.p[e-1]+1&&s.drawDividingLine(g,o,i),c(n))},f.src=s.getCurrentCDNHost(n)?n+"?p="+t:"data:image/png;base64,"+n}))},e.prototype.drawImg=function(e,t){var o=this;return new Promise((function(i,r){var n={},s=o.zoomInfo.zoom,h=o.viewInfo,f=h.parentWidth,p=h.parentHeight,l=h.viewWidth,u=h.viewHeight,d=h.rate,g=h.canvasRatio,v=t.getContext("2d"),m=new Image;m.onload=function(){var e={},r=m.width,n=m.height,h=n/r,y=r<=640&&n<=400,w=r<=1440&&h<=2.2&&h>=614/1280;if(o.clearImgError(v,l*s*g,u*s*g,0),y||w){var D=y?Math.min(640,f)/r:f/r,I=y?Math.min(400,p)/n:p/n,E=Math.min(D,I),T=(f-(_=r*E|0))/2,P=(p-(x=n*E|0))/2,S=_*s,C=x*s;t.style.cssText+="width:"+S+"px;height:"+C+"px;",S*=g,C*=g,t.width=S,t.height=C,v.fillStyle="white",v.fillRect(0,0,S,C),v.drawImage(m,0,0,S,C),e={x:T,y:P,w:_,h:x},a.Logger.info(c("draw_img_scale"),JSON.stringify({width:r,height:n,res:e}))}else{var _=r*d|0,x=n*d|0;T=Math.max((f-_)/2,0),P=Math.max((p-x)/2,0);t.style.cssText+="width:"+f*s+"px;height:"+x*s+"px;",t.width=f*s*g,t.height=x*s*g,v.fillStyle="white",v.fillRect(0,0,_*s*g,t.height),v.drawImage(m,0,0,_*s*g,t.height),e={x:T,y:P,w:f,h:p},a.Logger.info(c("draw_img_full"),JSON.stringify({width:r,height:n,draw_w:_,draw_h:x,rate:d}))}o.updateDocsViewLayout(e.x,e.y,e.w,e.h);var b=o.getFile();b.max_width=t.width/s/g,b.total_height=t.height/s/g,o.viewInfo.height=b.total_height,i()},m.onerror=function(e){o.changeImageCDNHost(m,n,"img")||(o.drawImgError(v,l*s*g,u*s*g,0,1),r(e))},m.src=o.getCurrentCDNHost(e)?e:"data:image/png;base64,"+e}))},e.prototype.createDocsView=function(){var e=this,t=s.DOMIDS.doc+this.id;if(!document.getElementById(t)){var o=document.createElement("div");o.id=s.DOMIDS.render+this.id,this.renderDom=o,(o=document.createElement("div")).id=t,o.setAttribute("data-page",this.viewInfo.total+""),o.setAttribute("data-mode",this.renderMode+""),o.addEventListener("zegowbevent",this.handleWhiteboardEvent.bind(this)),this.docDom=o;var i=document.createElement("div");i.id=s.DOMIDS.zoom+this.id,i.appendChild(this.renderDom),this.createImageLoading(i),i.appendChild(this.docDom);var r=document.getElementById(this.parent);r.style.position="relative",r.appendChild(i);o.addEventListener("scroll",(function(t){!e.zoomInfo.enable||e.viewInfo.ticking||e.zoomInfo.draging||(requestAnimationFrame((function(){var o=e.zoomInfo.zoom,i=t.target,r=Math.ceil(i.scrollTop),n=Math.ceil(i.scrollLeft),s=Math.ceil(r/o),a=Math.ceil(n/o);a!==e.viewInfo.scrollLeft?(e.viewInfo.scrollLeft=a,e.renderDom.scrollLeft=n):s!==e.viewInfo.scrollTop&&(e.onScrollCallback(r),e.viewInfo.scrollTop=s,e.renderDom.scrollTop=r,e.zoomInfo.scrollChanged=o>1),e.viewInfo.ticking=!1})),e.viewInfo.ticking=!0)})),o.addEventListener("mousedown",this.handleDragStart),this.isTouch&&(o.addEventListener("touchstart",this.handleDragStart),o.addEventListener("touchmove",(function(t){t.preventDefault(),e.handleDragEvent(t)})),o.addEventListener("touchend",(function(t){return e.handleDragEvent(t,!0)}))),o.addEventListener("mousemove",this.handleDragEvent),o.addEventListener("mouseup",(function(t){return e.handleDragEvent(t,!0)})),o.addEventListener("mouseleave",(function(t){return e.handleDragEvent(t,!0)}))}},e.prototype.createImageLoading=function(e){if(this.renderMode!==s.RenderMode.H5){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.setAttribute("version","1.1"),t.setAttribute("viewBox","0 0 1024 1024"),t.setAttribute("width","48"),t.setAttribute("height","48"),t.setAttribute("class","loading"),t.innerHTML=n.IMG_LOADING,this.loadingDom=t,e.appendChild(this.loadingDom)}},e.prototype.showImageLoading=function(e){this.loadingDom.style.display=e?"block":"none"},e.prototype.hideOtherDocsView=function(){var e=document.getElementById(this.parent);if(e){var t=s.DOMIDS.zoom+this.id;Array.from(e.children).forEach((function(e){e.style.display=e.id==t?"block":"none"}))}},e.prototype.updateDocsViewLayout=function(e,t,o,i){e|=0,t|=0,o|=0,i|=0,this.viewInfo.width=o,this.viewInfo.viewWidth=o,this.viewInfo.viewHeight=i;var r="width:"+o+"px;height:"+i+"px;left:"+e+"px;top:"+t+"px;";this.docDom.parentElement.style.cssText=r,this.docDom.style.width=o+"px",this.docDom.style.height=i+"px",this.renderDom.style.width=o+"px",this.renderDom.style.height=i+"px",a.Logger.info(c("layout"),JSON.stringify({x:e,y:t,w:o,h:i}))},e.prototype.createCanvas=function(){if(this.canvasArray.length)return!1;var e=this.zoomInfo.zoom+"",t=document.createElement("canvas");t.setAttribute("data-i","0"),t.setAttribute("data-zoom",e),this.canvasArray.push(t);var o=this.getFileType();if(o===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG)return!0;var i=this.viewInfo,r=i.parentWidth,n=i.parentHeight,h=i.height,f=i.sheet,p=i.canvasRatio,l=i.canvasMaxPage;if(this.renderMode===s.RenderMode.PPT){var u=this.vpageAspecCache[0][1],d=u.x,g=u.y,v=u.w,m=u.h;t.style.cssText+="width:"+v+"px;height:"+m+"px;",t.width=p*v,t.height=p*m,this.updateDocsViewLayout(d,g,v,m)}else{var y=this.getPageCount();if(y>l){y=Math.ceil(y/l);for(var w=0,D=this.vpageAspecCache[f],I=0;I<y;I++)w+=this.getCanvasHeight(I);if(w=h-w,Math.abs(w)>10&&y>2){var E=w>0?1:-1;w=w>0?w:-w;var T=Math.ceil(y>w?y/w:w/w),P="diff="+E*w+",step="+T+",count="+y+",equal="+this.getFile().isEqualAspec;a.Logger.info(c("pdf_diff_canvas"),P);for(I=1;I<y;)D.h[I]+=E,I+=T}for(I=1;I<y;I++){var S=document.createElement("canvas");S.setAttribute("data-i",I+""),S.setAttribute("data-zoom",e);var C=this.getCanvasHeight(I);S.style.cssText+="width:"+r+"px;height:"+C+"px;",S.width=r*p,S.height=C*p,this.canvasArray.push(S)}}m=this.getCanvasHeight(0);if(t.style.cssText+="width:"+r+"px;height:"+m+"px;",t.width=r*p,t.height=m*p,o===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS&&this.getDocViewChild())this.resetVisibleSize();else{g=Math.max((n-h)/2,0);var _=Math.min(n,h);this.updateDocsViewLayout(0,g,r,_)}}return!0},e.prototype.renderCanvas=function(){var e=this.viewInfo,t=e.width,o=e.height,i=this.getDocViewChild(),r=!!i,n="width:"+t+"px;height:"+o+"px;"+(this.zoomInfo.zoom>1?"transform:scale("+this.zoomInfo.zoom+");":"");if(i||(i=document.createElement("div"),this.docDom.appendChild(i)),i.style.cssText=n,r){if(this.getFileType()==s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS){var a=document.createDocumentFragment();this.canvasArray.forEach((function(e){return a.appendChild(e)})),(i=this.renderDom.firstChild).style.cssText=n,(i=this.renderDom.lastChild).style.cssText=n,i.innerHTML="",i.appendChild(a)}}else if(this.renderMode===s.RenderMode.PPT)this.renderDom.appendChild(this.canvasArray[0]);else{var c=document.createDocumentFragment();(i=document.createElement("div")).style.cssText=n,c.appendChild(i),(i=document.createElement("div")).style.cssText=n,this.canvasArray.forEach((function(e){return i.appendChild(e)})),c.appendChild(i),this.renderDom.appendChild(c)}this.setDocsViewDomOverflow(),0!==this.ifCanvasLoadedScrollTop&&-1!==this.ifCanvasLoadedScrollTop&&this.handleScroll(this.ifCanvasLoadedScrollTop),this.ifCanvasLoadedScrollTop=-1},e.prototype.afterDrawCanvas=function(e,t){this.docDom&&e&&this.renderCanvas(),t&&t(),this.showImageLoading(!1)},e.prototype.drawCanvas=function(e,t){var o=this;this.renderMode===s.RenderMode.PPT&&(e=e.filter((function(e){return e.virtual_page_number===o.ppth5Info.page}))),this.createDocsView(),this.hideOtherDocsView(),this.showImageLoading(!0);for(var i=this.createCanvas(),r=this.canvasArray[0],n=0,h={id:this.id},f=[],p=this.zoomInfo.zoom,l=this.vpageAspecCache[this.viewInfo.sheet],u=0;u<e.length;++u){var d=e[u],g=d.image_data,v=d.image_path,m=d.virtual_page_number;if(g)if(this.renderMode===s.RenderMode.PPT){var y=l[m],w=y.w,D=y.h,I=this.drawPPT(m,w*p,D*p,g,r);f.push(I)}else{var E=l[m],T=E.p;w=E.w,D=E.h,I=this.drawPDF(T,m,n*p,w*p,D*p,g);f.push(I),n+=D,h[m]=this.vpageDrawCache[m]}else if(v){I=this.drawImg(v,r);f.push(I)}}this.canvasArray.length>1&&a.Logger.info(c("draw_cache"),JSON.stringify(h)),Promise.all(f).then((function(){return o.afterDrawCanvas(i,t)}),(function(){return o.afterDrawCanvas(i,t)}))},e.prototype.drawHtml=function(e,t){this.createDocsView(),this.hideOtherDocsView();var o=s.DOMIDS.iframe+this.id;if(!document.getElementById(o)){var i=this.vpageAspecCache[0][1],r=i.x,n=i.y,a=i.w,c=i.h,h=this.getFile().page_list[0].width;(window.hasOwnProperty("ontouchstart")||a-h>4)&&(this.ppth5Info.scale=Number((a/h).toFixed(4)));var f=document.createElement("iframe");f.id=o,f.allow="autoplay",f.width=a,f.height=c,f.src=e[0].image_data+"#"+this.id,this.iframeDom=f;var p="width:"+a+"px;height:"+this.viewInfo.height+"px;",l=document.createElement("div");l.style.cssText=p,this.docDom.appendChild(l),this.renderDom.style.zIndex="1",this.renderDom.appendChild(f),this.updateDocsViewLayout(r,n,a,c),this.setDocsViewDomOverflow(),window.addEventListener("message",this.handleIframeMessage.bind(this))}t&&t()},e.prototype.execDraw=function(e,t){var o=this;this.clearCanvasIfNeed();var i=e,r=e;if(this.renderMode===s.RenderMode.PDF){var n=this.getCanvasSplit(e);i=n.start,r=n.end}var a=this.getAllVirtualInPageRange(i-1,r-1);this.startGetImageByVirtualPageList(a,(function(e){o.renderMode===s.RenderMode.H5?o.drawHtml(e,t):o.drawCanvas(e,t)}))},e.prototype.execScrollFileAndDraw=function(e,t,o){var i=this;if(this.canvasArray.length>1){var r=Date.now(),n=r-this.viewInfo.lastTime;if(this.viewInfo.lastTime=r,n<s.INTERVAL_PAGE)return this.viewInfo.lastTimeId&&clearTimeout(this.viewInfo.lastTimeId),void(this.viewInfo.lastTimeId=window.setTimeout((function(){o?o.forEach((function(e){return i.execDraw(e,t)})):i.execDraw(i.ppth5Info.page,t);var r={p:i.ppth5Info.page,page:e,zoom:i.zoomInfo.zoom,pages:o};a.Logger.info(c("draw_scrolled"),JSON.stringify(r))}),s.INTERVAL_PAGE))}this.execDraw(e,t)},e.prototype.onScrollCallback=function(e,t){var o=this.zoomInfo.zoom,i=this.viewInfo,r=i.total,n=i.height,a=i.viewHeight,c=i.scrollTop;if(this.renderMode===s.RenderMode.PDF&&n>a){var h=this.getPageByScrollTop(e),f=Number((e/n/o).toFixed(7));if(this.triggerOnScrollEventListener(e,h,f),t||this.ppth5Info.page!==h){if(this.ppth5Info.page=h,this.postPageChangeMessage(e,!0,t),this.execScrollFileAndDraw(h),this.viewInfo.isParentScale)(p=document.getElementById(this.parent))&&this.drawPDFBlank(p.clientHeight,e/o)}else if(h>1&&h<r)if(this.viewInfo.isParentScale){var p;(p=document.getElementById(this.parent))&&this.drawPDFBlank(p.clientHeight,e/o)}else{var l=e>c*o?1:-1;this.getCanvasSplit(h).index!==this.getCanvasSplit(h+l).index&&this.execScrollFileAndDraw(h+l)}}},e.prototype.loadCurrentSheet=function(e,t){var o=this.getFile();if(o){var i=this.getFileType();this.viewInfo.width=o.max_width,this.viewInfo.height=o.total_height,this.viewInfo.total=o.page_count,this.viewInfo.rate=o.rate,i===s.ZegoDocsViewFileType.ZegoDocsViewFileTypePPT?this.renderMode=s.RenderMode.PPT:i===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeDynamicPPTH5&&(this.renderMode=s.RenderMode.H5),i===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS&&t&&(this.docDom.scrollTop=0,this.renderDom.scrollTop=0,this.canvasArray.length=0),this.execScrollFileAndDraw(this.ppth5Info.page,e?this.onLoadFileCallback:void 0)}},e.prototype.checkPDF2PPT=function(e,t){if(e===s.ZegoDocsViewFileType.ZegoDocsViewFileTypePDF){var o=t.page_list[0],i=o.width,r=o.height,n=i+","+r;if(r/i<=1&&r/i>=614/1280)if(t.page_list.map((function(e){return e.width+","+e.height})).every((function(e){return e===n})))return this.renderMode=s.RenderMode.PPT,!0}return!1},e.prototype.calculateFileAspec=function(e){for(var t=0,o=0,i=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,n=0,s=e.page_list;n<s.length;n++){var a=s[n];a.width>t&&(t=a.width),a.width<i&&(i=a.width),a.height>o&&(o=a.height),a.height<r&&(r=a.height)}return e.maxWidth=t,e.max_width=t,e.min_width=i,e.max_height=o,e.min_height=r,e.rate=this.viewInfo.parentWidth/t,e},e.prototype.init=function(e,t){var o=this;this.parent=e,this.id=t,this.ppth5Info.p=e,this.serviceHandle.registerEventHandler(this.id,"onDocsLoadPdf",(function(e){o.tranlateFileAspec(e),Object.assign(o.fileInfo,e),o.loadCurrentSheet(!0)}))},e.prototype.tranlateFileAspec=function(e){this.setParentWidthHeight(this.parent);for(var t=e.document_type,o=this.viewInfo,r=o.sheetName,n=o.parentWidth,a=o.parentHeight,c=o.canvasRatio,h=function(o){var h={vs:1,p:{0:0},h:{}};f.vpageAspecCache[o]=h;var p=e.file_list[o];if(t===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS?(p.page_count=p.page_list.length,p.file_name=p.file_name.replace(/\.[a-zA-Z]+$/,""),p.file_name===r&&(f.viewInfo.sheet=o)):p.page_count=e.page_count||p.page_list.length,t===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG||t===s.ZegoDocsViewFileType.ZegoDocsViewFileTypePPT||t===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeDynamicPPTH5||f.checkPDF2PPT(t,p)){var l=p.page_list[0],u=l.width,d=l.height,g=n,v=d*g/u;(v>a||Math.abs(v-a)<=1)&&(g=a*n/v|0,v=a),p.max_width=g,p.total_height=v*p.page_count|0,p.rate=n/u;for(var m={p:1,x:(n-g)/2,y:(a-(v|=0))/2,w:g,h:v},y=1;y<=p.page_count;++y)h[y]=i(i({},m),{p:y}),h.p[y]=1}else{h.vs=p.page_list[0].virtual_page_list[0].virtual_page_number;var w=f.calculateFileAspec(p),D=w.max_width,I=w.min_width,E=w.max_height,T=w.min_height,P=Math.abs(D-I)<5&&Math.abs(E-T)<5;P&&(p.total_height=Math.round(p.page_count*E*n/I));var S=0,C=h.vs-1;p.page_list.forEach((function(e,t){var o=e.virtual_page_list.length;C+=o,h.p[t+1]=C;var i={p:t+1,x:0,y:0,w:n};P?i.h=Number((p.total_height/p.page_count/o).toFixed(4)):(i.h=Number((e.height*n/D/o).toFixed(4)),S+=e.height*n/D);for(var r=0,s=e.virtual_page_list;r<s.length;r++){var a=s[r];h[a.virtual_page_number]=i}})),P||(p.total_height=Math.round(S)),p.max_width=n,p.isEqualAspec=P;var _=Math.floor(16e3*p.page_count/(3*c*p.total_height))||1;f.viewInfo.canvasMaxPage=_}},f=this,p=0;p<e.file_list.length;++p)h(p)},e.prototype.handleScroll=function(e){var t=this;if(this.docDom){var o=this.zoomInfo,i=o.zoom,r=o.enable,n=this.viewInfo,a=n.height,c=n.total,h=this.ppth5Info.page,f=this.renderMode===s.RenderMode.PDF;if(f&&(r&&(this.viewInfo.ticking=!0,setTimeout((function(){return t.viewInfo.ticking=!1}),34)),this.docDom.scrollTop=e,this.renderDom.scrollTop=e,this.viewInfo.scrollTop=Math.ceil(e/i),this.zoomInfo.scrollChanged=!0),this.renderMode!==s.RenderMode.H5)if(this.viewInfo.isParentScale){this.execScrollFileAndDraw(h);var p=document.getElementById(this.parent);p&&this.drawPDFBlank(p.clientHeight,this.viewInfo.scrollTop)}else this.execScrollFileAndDraw(h);this.postPageChangeMessage(e,f);var l=f?e/a/i:(h-1)/c;this.triggerOnScrollEventListener(e,h,Number(l.toFixed(7)))}},e.prototype.getScrollTopByPage=function(e){if(this.viewInfo.total<=1||e<=1)return 0;if(this.renderMode===s.RenderMode.PPT||this.renderMode===s.RenderMode.H5)return(e-1)*this.viewInfo.viewHeight*this.zoomInfo.zoom+2;for(var t=this.vpageAspecCache[this.viewInfo.sheet],o=t.p[e-1],i=0,r=t.vs;r<=o;r++)i+=t[r].h;return i*=this.zoomInfo.zoom},e.prototype.getPageByScrollTop=function(e){var t=this.viewInfo,o=t.sheet,i=t.viewHeight,r=this.zoomInfo.zoom,n=this.getFileType(),a=Math.ceil(.5*i);if(n===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG||e<=a)return 1;if(this.renderMode===s.RenderMode.PPT||this.renderMode===s.RenderMode.H5)return Math.round(e/r/i)+1;for(var c=this.vpageAspecCache[o],h=-a,f=c.vs;h<=e&&c[f];)h+=c[f].h*r,f++;return c[f-1].p},e.prototype.getDocViewChild=function(){return this.docDom.firstChild},e.prototype.postZoomDragMessage=function(e,t,o){if(this.wbId){var i={action:"zoomdrag",x:e,y:t,notify:o};this.docDom.dispatchEvent(new CustomEvent("zegodocsevent",{detail:i}))}},e.prototype.postPageChangeMessage=function(e,t,o){if(this.wbId){var i={action:"page",page:this.ppth5Info.page,pageCount:this.viewInfo.total,y:e||this.getScrollTopByPage(this.ppth5Info.page),step:this.ppth5Info.step,scroll:t,notify:void 0===o?this.ppth5Info.notify:o};this.docDom.dispatchEvent(new CustomEvent("zegodocsevent",{detail:i})),this.renderMode!==s.RenderMode.PDF&&this.setDocsViewDomTransform(this.zoomInfo.tx,this.zoomInfo.ty)}},e.prototype.postStepChangeMessage=function(){var e={parent:this.parent,page:this.ppth5Info.page,step:this.ppth5Info.step,fileID:this.getFileID(),fileType:this.getFileType(),fileName:this.getFile().file_name,notify:this.ppth5Info.notify};this.ppth5Info.scene&&(e.scene=this.ppth5Info.scene),this.serviceHandle.triggerEventListener("onStepChange",e),this.postPageChangeMessage(),this.ppth5Info.scene=0},e.prototype.postTargetClickMessage=function(e){var t={parent:this.parent,page:this.ppth5Info.page,step:this.ppth5Info.step,fileID:this.getFileID(),fileType:this.getFileType(),fileName:this.getFile().file_name,data:e};if(this.serviceHandle.triggerEventListener("onPlayAnimation",t),this.wbId){var o={action:"targetclick",data:e,notify:!0};this.docDom.dispatchEvent(new CustomEvent("zegodocsevent",{detail:o}))}},e.prototype.postErrorMessage=function(e){e="object"==typeof e?e:s.transError(e);var t=i({parent:this.parent,fileID:this.getFileID(),fileType:this.getFileType(),fileName:this.getFile().file_name},e);this.serviceHandle.triggerEventListener("onError",t)},e.prototype.triggerOnScrollEventListener=function(e,t,o){this.viewInfo.percent=o;var i=this.getFile(),r={parent:this.parent,percent:o,page:t,y:e,fileID:this.fileInfo.fileID,fileType:this.getFileType(),fileName:i.file_name,name:i.name||""};this.serviceHandle.triggerEventListener("onScroll",r)},e.prototype.postMessage2iframe=function(e,t){var o=this.iframeDom;o&&o.contentWindow&&o.contentWindow.postMessage({source:"zegodocsview",action:e,args:t||[]},"*")},e.prototype.handleWhiteboardEvent=function(e){var t=e&&e.detail,o=t.action,i=t.vPercent,r=t.step,n=t.notify,h=t.enable,f={oldpage:this.ppth5Info.page,oldstep:this.ppth5Info.step,data:t};if("page"===o){this.ppth5Info.notify=n;var p=t.y,l=1;"number"==typeof i?(l=Math.min(Math.round(i*this.viewInfo.total)+1,this.viewInfo.total),p=this.getScrollTopByPage(l)):l=this.getPageByScrollTop(p),this.renderMode===s.RenderMode.H5?this.syncWhiteboardPPTH5Queue(l,r):(this.ppth5Info.page=l,this.handleScroll(p)),f.page=l,f.step=r}else if("scale"===o)this.setScaleFactor(t.zoom,t.x,t.y);else if("drag"===o){var u=this.zoomInfo.enable;this.zoomInfo.enable=h,this.zoomInfo.drag=t.drag,u!==h&&this.setDocsViewDomOverflow()}else if("init"===o){this.wbId=t.id,a.Logger.setExtraConfig({wbId:this.wbId});var d={action:"getAspectCache",vpageAspecCache:JSON.parse(JSON.stringify(this.vpageAspecCache[this.viewInfo.sheet]))};setTimeout((function(){e.target.dispatchEvent(new CustomEvent("zegodocsevent",{detail:d}))}))}else"targetclick"===o?(this.ppth5Info.notify=!1,t.isPush?this.playAnimation(t.data):(this.viewInfo.firstInfo.page=this.ppth5Info.page,this.viewInfo.firstInfo.step=this.ppth5Info.step,this.viewInfo.firstInfo.h5Extra=t.data)):"destroy"===o&&this.unloadFile();a.Logger.info(c("zegowbevent"),JSON.stringify(f))},e.prototype.tryInitPageStep=function(e){var t=this;void 0===e&&(e=500),this.ppth5Info.goPage&&this.ppth5Info.goStep&&(this.ppth5Info.goTimer&&clearTimeout(this.ppth5Info.goTimer),this.ppth5Info.goTimer=window.setTimeout((function(){var e=t.ppth5Info,o=e.goPage,i=e.goStep;o&&i&&(t.execGotoPage(o,i,!1),a.Logger.info(c("h5_init_timeout"),JSON.stringify({id:t.id,h5:t.ppth5Info})))}),e))},e.prototype.handleIframeMessage=function(e){var t=this,o=e.data;if(o&&"zegodocsview"===o.source){var i=o.action,r=o.res,n=o.hash;if(!n||n==="#"+this.id)if("syncDOMEvent"!==i&&a.Logger.info(c("h5_iframe"),JSON.stringify(o)),"syncCurrentPage"===i)if(this.ppth5Info.loaded)"boolean"==typeof r.notify&&(this.ppth5Info.notify=r.notify),this.ppth5Info.pageChangeTimer&&clearTimeout(this.ppth5Info.pageChangeTimer),this.ppth5Info.pageChangeTimer=window.setTimeout((function(e){t.ppth5Info.page=e[0],t.ppth5Info.step=e[1],t.ppth5Info.scene=e[2],t.postStepChangeMessage()}),16,[+r.page+1,(r.step||0)+1,r.scene]);else{a.Logger.info(c("h5_init_page"),JSON.stringify({id:this.id,h5:this.ppth5Info})),this.ppth5Info.loaded=!0;var h=this.ppth5Info,f=h.targetPage,p=h.targetStep;f>1?(this.ppth5Info.goPage=f,this.ppth5Info.goStep=p,this.ppth5Info.page=f,this.gotoPage(!1)):p<=1&&(this.postStepChangeMessage(),this.firstNeedPlayAnimation())}else if("syncCurrentStep"===i&&this.ppth5Info.loaded){this.ppth5Info.pageChangeTimer&&clearTimeout(this.ppth5Info.pageChangeTimer);var l=r.page+1,u=+r.step+1,d=this.ppth5Info.lastStep;if(this.ppth5Info.lastStep=l===this.ppth5Info.page?u:-1,0==u||0==d&&1==u)return;if("boolean"==typeof r.notify&&(this.ppth5Info.notify=r.notify),a.Logger.info(c("h5_step"),JSON.stringify({id:this.id,page:l,step:u,notify:r.notify,h5:this.ppth5Info})),u!==this.ppth5Info.step||l!==this.ppth5Info.page)if(this.ppth5Info.step=u,this.tryInitPageStep(),this.ppth5Info.targetPage||this.ppth5Info.targetStep){if(this.ppth5Info.page!==l){this.ppth5Info.page=l,this.postPageChangeMessage();var g=(l-1)*this.viewInfo.viewHeight;m=Number(((l-1)/this.viewInfo.total).toFixed(7));this.triggerOnScrollEventListener(g,l,m)}}else{if(this.ppth5Info.page!==l){this.ppth5Info.page=l;var v=(l-1)*this.viewInfo.viewHeight,m=Number(((l-1)/this.viewInfo.total).toFixed(7));this.triggerOnScrollEventListener(v,l,m)}a.Logger.info(c("h5_queue_done"),JSON.stringify({id:this.id,page:l,step:u,action:"step"})),this.firstNeedPlayAnimation(),this.postStepChangeMessage(),this.execSyncPPTH5Queue(),this.execMultiDocsQueue()}this.ppth5Info.page===this.ppth5Info.targetPage&&(this.ppth5Info.targetStep<u?this.previousStep(this.ppth5Info.notify):this.ppth5Info.targetStep>u?this.nextStep(this.ppth5Info.notify):(this.ppth5Info.targetPage=0,this.ppth5Info.targetStep=0,this.ppth5Info.goPage=0,this.ppth5Info.goStep=0,a.Logger.info(c("h5_queue_done"),JSON.stringify({id:this.id,page:l,step:u,action:"page"})),this.firstNeedPlayAnimation(),this.postStepChangeMessage(),this.execSyncPPTH5Queue(),this.execMultiDocsQueue()))}else if("syncCurrentElement"===i)this.postTargetClickMessage(r);else if("syncDOMEvent"===i&&this.domEventListeners){var y=this.domEventListeners[r.type];y&&y(r)}else if("syncCurrentError"===i)r.code===s.ZegoDocsViewError.ZegoDocsViewErrorNetworkTimeout?this.changeH5CDNHost():this.postErrorMessage(r);else if("uploadLog"===i)a.Logger.info(c("h5_log"),r);else if("onload"===i){var w=this.serviceHandle.getStore();this.postMessage2iframe("setCustomizedConfig",["scale",this.ppth5Info.scale]),this.domEventListeners&&this.postMessage2iframe("setCustomizedConfig",["syncDOMEvent"]);var D=s.ZegoConfigKey.PptStepMode;this.postMessage2iframe("setCustomizedConfig",[D,w[D]]),D=s.ZegoConfigKey.DisableH5ImageDrag,this.postMessage2iframe("setCustomizedConfig",[D,w[D]])}}},e.prototype.dragPDF=function(e,t){var o=this.zoomInfo,i=o.tx,r=o.ty,n=o.zoom,s=o.enable,a=this.viewInfo,c=a.width,h=a.height,f=a.viewHeight,p=a.scrollTop,l=e instanceof TouchEvent?e.changedTouches[0]:e,u=l.clientX,d=l.clientY,g=i+this.zoomInfo.x-u,v=r+this.zoomInfo.y-d,m=c*(n-1);g<0?g=0:g>m&&(g=m);var y=s?0:p*n;m=s?h*n-f:(p+f)*n-f,v<y?v=y:v>m&&(v=m),s&&(this.viewInfo.scrollLeft=Math.ceil(g/n),this.viewInfo.scrollTop=Math.ceil(v/n),this.zoomInfo.scrollChanged=!0),this.postZoomDragMessage(0,0,!1),this.viewInfo.ticking=!0,this.zoomInfo.draging=!0,this.docDom.scrollTo(g,v),this.renderDom.scrollTo(g,v),this.viewInfo.ticking=!1,t&&(this.zoomInfo.x=0,this.zoomInfo.y=0,this.zoomInfo.draging=!1,this.postZoomDragMessage(0,0,!0),s&&this.onScrollCallback(v,!0))},e.prototype.dragPPT=function(e,t){var o=this.zoomInfo,i=o.tx,r=o.ty,n=o.zoom,s=this.viewInfo,a=s.viewWidth,c=s.viewHeight,h=e instanceof TouchEvent?e.changedTouches[0]:e,f=h.clientX,p=h.clientY,l=i+f-this.zoomInfo.x,u=r+p-this.zoomInfo.y,d=a*(1-n);l>0?l=0:l<d&&(l=d),d=c*(1-n),u>0?u=0:u<d&&(u=d),t?(this.zoomInfo.tx=l,this.zoomInfo.ty=u,this.zoomInfo.x=0,this.zoomInfo.y=0):this.setDocsViewDomTransform(l,u)},e.prototype.drawPDFBlank=function(e,t){var o=this;if(!(this.canvasArray.length<2)){for(var i=t,r=0,n=0;n<i;)n+=this.getCanvasHeight(r++);var s=r>0?r-1:0;for(i+=e,r=0,n=0;n<i;){var h=this.getCanvasHeight(r++);if(n+=h,0===h)break}for(var f=this.viewInfo,p=f.canvasMaxPage,l=f.isParentScale,u=r>0?r-1:0,d=[];s<=u;s++)d.push(s*p+1);if(l)this.execScrollFileAndDraw(d[0],void 0,d);else{d.forEach((function(e){return o.execDraw(e,void 0)}));var g={id:this.id,pages:d};a.Logger.info(c("draw_scrolled"),JSON.stringify(g))}}},e.prototype.firstNeedPlayAnimation=function(){var e=this.viewInfo.firstInfo,t=e.page,o=e.step,i=e.h5Extra;t&&i&&t==this.ppth5Info.page&&o==this.ppth5Info.step&&(this.playAnimation(i),this.viewInfo.firstInfo.page=0,this.viewInfo.firstInfo.step=0)},e.prototype.getAllVirtualInPageRange=function(e,t){var o=this.getFile().page_list,i=[];e<0&&(e=0),t>=o.length&&(t=o.length-1);for(var r=e;r<=t;++r)for(var n=0,s=o[r].virtual_page_list;n<s.length;n++){var a=s[n];i.push(a.virtual_page_number)}return i},e.prototype.startGetImageByVirtualPageList=function(e,t){for(var o=[],i=this.vpageImgCache[this.viewInfo.sheet],r=0;r<e.length;){var n=i&&i[e[r]];n?(o.push(n),e.splice(r,1)):r++}this.getImageByVirtualPageList(o,e,t)},e.prototype.sortVirtualPageListRule=function(e,t){return e.virtual_page_number-t.virtual_page_number},e.prototype.getImageByVirtualPageList=function(e,t,o){var i=this;if(t.length<=0)return e.sort(this.sortVirtualPageListRule),void o(e);this.serviceHandle.registerEventHandler(this.id,"onDocsGetPDFPageImage",(function(r){for(var n=r.virtual_page_number,s=0;s<t.length;++s)if(t[s]==n){t.splice(s,1);break}var a=i.vpageImgCache[i.viewInfo.sheet]||{};a[n]=r,i.vpageImgCache[i.viewInfo.sheet]=a;var c=!1;for(s=0;s<e.length;++s)e[s].virtual_page_number==n&&(e[s]=r,c=!0);c||e.push(r),i.getImageByVirtualPageList(e,t,o)}));var r=this.viewInfo,n=r.sheet,s=r.rate;this.serviceHandle.getPageImage(this.id,{sheet:n,rate:s,file_id:this.fileInfo.fileID,virtual_page_number:t[0],virtual_start:this.vpageAspecCache[n].vs-1,res:this.fileInfo})},e.prototype.getFile=function(){return this.fileInfo.file_list[this.viewInfo.sheet]},e.prototype.execGotoPage=function(e,t,o){e!==this.ppth5Info.page?(this.ppth5Info.page=e,this.ppth5Info.step=1,this.gotoPage(o)):t<this.ppth5Info.step?this.previousStep(this.ppth5Info.notify):t>this.ppth5Info.step?this.nextStep(this.ppth5Info.notify):t!==this.ppth5Info.step||1===this.ppth5Info.targetPage&&1===this.ppth5Info.targetStep||(this.ppth5Info.targetPage=0,this.ppth5Info.targetStep=0)},e.prototype.runGotoPageQueue=function(e,t,o,i){var r=this;this.ppth5Info.targetPage=e,this.ppth5Info.targetStep=t,this.execGotoPage(e,t,o);var n=this.ppth5Info.loaded?s.SYNC_PPT_TIME:s.SYNC_PPT_INIT_TIME;this.ppth5Info.syncTimer&&clearTimeout(this.ppth5Info.syncTimer),this.ppth5Info.syncTimer=window.setTimeout((function(){return r[i](!0)}),n)},e.prototype.syncWhiteboardPPTH5Queue=function(e,t){var o=this,i=this.ppth5Info,r=i.page,n=i.step,s=i.loaded,h={page:e,step:t,notify:i.notify,loaded:s,id:this.id},f=this.serviceHandle.getStore();f.syncPPTH5Queue=f.syncPPTH5Queue&&f.syncPPTH5Queue.length?f.syncPPTH5Queue.filter((function(e){return e.id===o.id})):[];var p=f.syncPPTH5Queue[f.syncPPTH5Queue.length-1];if(!p||p.page===e&&p.step===t)p||(f.syncPPTH5Queue=[h],this.runGotoPageQueue(h.page,h.step,h.notify,"execSyncPPTH5Queue"));else{var l={page:r,step:n,task:h,queue:f.syncPPTH5Queue.map((function(e){return e.page+"-"+e.step})).join()};f.syncPPTH5Queue.push(h),a.Logger.info(c("h5_wbqueue_push"),JSON.stringify(l))}},e.prototype.execSyncPPTH5Queue=function(e){var t=this.serviceHandle.getStore(),o=t.syncPPTH5Queue,i=e&&t.syncQueueRuning;if(i&&this.execQueueTimeout(o),t.syncQueueRuning=!1,o&&o.length){t.syncQueueRuning=!0;var r=o.shift();i&&!o[0]||(r=o[0]),r&&(a.Logger.info(c("h5_wbqueue_pop"),JSON.stringify({timeout:e,task:r,store:t})),this.runGotoPageQueue(r.page,r.step,r.notify,"execSyncPPTH5Queue"))}},e.prototype.execMultiDocsQueue=function(e){var t=this,o=this.serviceHandle.getStore(),i=o.multiDocsQueue;if(e&&o.syncQueueRuning&&this.execQueueTimeout(i),o.syncQueueRuning=!1,i&&i.length){o.syncQueueRuning=!0;var n=[],s=i.shift();n.push(s);for(var h=0;h<i.length;h++){var f=i[h];f&&f.id!==s.id&&f.p!==s.p&&(s=f,n.push(s),i.splice(h,1))}a.Logger.info(c("h5_mdqueue_pop"),JSON.stringify({timeout:e,tasks:n,store:o})),n.forEach((function(e){t.serviceHandle.triggerEventListener("onViewMessage",{action:"runGotoPageQueue",id:e.id,args:r(e.args,["execMultiDocsQueue"])})}))}},e.prototype.execQueueTimeout=function(e){if(e&&e.length){for(var t=[],o=0;o<e.length-1;o++)e[o]&&!e[o].loaded&&(t.push(e[o]),e.splice(o,1));var i={id:this.id,loaded:this.ppth5Info.loaded,queue:e,tasks:t};a.Logger.info(c("h5_queue_timeout"),JSON.stringify(i))}this.ppth5Info.loaded=!0,this.ppth5Info.targetPage=0,this.ppth5Info.targetStep=0,this.postStepChangeMessage(),this.postMessage2iframe("hideLoadingStyle")},e.prototype.gotoPage=function(e){this.viewInfo.total>1&&this.ppth5Info.page<=this.viewInfo.total&&(this.renderMode===s.RenderMode.H5&&(this.ppth5Info.notify=e,this.postMessage2iframe("gotoPage",[this.ppth5Info.page-1,e])),this.handleScroll(this.getScrollTopByPage(this.ppth5Info.page)))},e.prototype.setSheetName=function(e){this.viewInfo.sheetName=e},e.prototype.checkParamsPage=function(e){var t=this.getPageCount();return e<1?e=1:e>t?e=t:e|=0,e},e.prototype.clearNeighboringCanvas=function(e){var t=this,o=this.viewInfo,i=o.sheet,r=o.total,n=o.canvasMaxPage,h=o.viewWidth,f=o.canvasRatio,p=this.zoomInfo.zoom,l=[];if(this.canvasArray.length>1){var u=(this.ppth5Info.page-1)%n;0===u&&e>0?(l.push({i:e-1,h:this.getCanvasHeight(e-1)}),l.push({i:e,h:this.getCanvasHeight(e)})):u===n-1&&e<this.canvasArray.length-1&&(l.push({i:e,h:this.getCanvasHeight(e)}),l.push({i:e+1,h:this.getCanvasHeight(e+1)}))}if(l.length||l.push({i:e,h:this.getCanvasHeight(e)}),this.renderMode===s.RenderMode.PDF){var d=this.vpageDrawCache,g=this.vpageAspecCache[i],v=l[0].i*n+1,m=l[1]?l[1].i:l[0].i;m=Math.min(m*n+n,r),v=g.p[v-1]+1,m=g.p[m],a.Logger.info(c("draw_clear"),JSON.stringify({index:e,start:v,end:m,zoom:p}));for(var y=v;y<=m;y++)d[y]=0}l.forEach((function(e){var o=t.canvasArray[e.i];o.getContext("2d").clearRect(0,0,h*p*f,e.h*p*f),o.setAttribute("data-zoom",p+"")}))},e.prototype.clearCanvasIfNeed=function(){if(this.canvasArray.length>1){var e=this.getCanvasSplit(this.ppth5Info.page).index;+(this.canvasArray[e].getAttribute("data-zoom")||"1")!=this.zoomInfo.zoom&&this.clearNeighboringCanvas(e)}},e.prototype.resetAllCanvas=function(){var e=this.zoomInfo.zoom,t=this.viewInfo,o=t.canvasRatio,i=e*t.viewWidth,r=e*this.getCanvasHeight(0),n=this.canvasArray[0];n.style.cssText+="width:"+i+"px;height:"+r+"px;",n.width=i*o,n.height=r*o;for(var a=1;a<this.canvasArray.length;a++){var c=this.canvasArray[a],h=e*this.getCanvasHeight(a);c.style.cssText+="width:"+i+"px;height:"+h+"px;",c.width=i*o,c.height=h*o}var f=this.renderMode===s.RenderMode.PDF?this.getCanvasSplit(this.ppth5Info.page).index:0;this.clearNeighboringCanvas(f)},e.prototype.delayDraw=function(e){var t=this;return function(o){t.isAppleDevice()?setTimeout(e.bind(t,o)):e(o)}},e.prototype.isAppleDevice=function(){var e=navigator.userAgent,t=e.includes("Mac"),o=!e.includes("Chrome")&&e.includes("Safari");return this.isTouch?t:o},e.prototype.getCDNHostList=function(){return this.fileInfo.cdn_hosts||[]},e.prototype.loadFile=function(e,t){return this.fileInfo.fileID=e,this.fileInfo.authKey=t,this.viewInfo.ticking=!1,a.Logger.setExtraConfig({fileID:e}),this.serviceHandle.load(this.id,{fileID:e,authKey:t},!0)},e.prototype.unloadFile=function(){var e,t,o=null===(e=this.docDom)||void 0===e?void 0:e.parentElement;o&&(null===(t=o.parentElement)||void 0===t||t.removeChild(o),a.Logger.info(c("unloadFile"))),this.serviceHandle.triggerEventListener("onViewMessage",{action:"unloadFile",id:this.id,args:[]})},e.prototype.getContentSize=function(){return{width:this.viewInfo.width,height:this.viewInfo.height}},e.prototype.resetVisibleSize=function(){if(this.docDom&&this.renderMode===s.RenderMode.PDF){var e=document.getElementById(this.parent),t=e.clientWidth,o=e.clientHeight,i="width:"+t+"px;height:"+o+"px;",r=this.docDom.parentElement;this.docDom.style.cssText+=i+"overflow: hidden auto;",this.renderDom.style.cssText+=i+"overflow: hidden auto;",r.style.cssText+=i+"top:"+Math.max(0,(o-this.viewInfo.height)/2)+"px;",this.drawPDFBlank(o,this.viewInfo.scrollTop),this.viewInfo.isParentScale=!0}},e.prototype.getVisibleSize=function(){return{width:this.viewInfo.viewWidth,height:this.viewInfo.viewHeight}},e.prototype.getFileID=function(){return this.fileInfo.fileID},e.prototype.getFileType=function(){return this.fileInfo.document_type},e.prototype.getCurrentPage=function(){return this.ppth5Info.page},e.prototype.getCurrentStep=function(){return this.ppth5Info.step},e.prototype.getPageCount=function(){return this.viewInfo.total},e.prototype.getPPTNotes=function(e){return e=this.checkParamsPage(e),this.fileInfo.notes[e-1]||""},e.prototype.getThumbnailUrlList=function(){return this.fileInfo.thumbnails},e.prototype.getVerticalPercent=function(){return this.viewInfo.percent},e.prototype.scrollTo=function(e,t){this.ppth5Info.notify=void 0===t||!!t;var o=Math.ceil(this.viewInfo.height*e*this.zoomInfo.zoom),i=this.getPageByScrollTop(o);this.ppth5Info.page=i,this.handleScroll(o),-1!==this.ifCanvasLoadedScrollTop&&(this.ifCanvasLoadedScrollTop=o),a.Logger.info(c("scrollTo"),JSON.stringify({id:this.id,params:e,page:i,top:o}))},e.prototype.flipPage=function(e,t,o){if(e=this.checkParamsPage(e),t="number"==typeof t?Math.max(1,0|t):1,o=void 0===o||!!o,this.ppth5Info.notify=o,this.wbId)this.syncWhiteboardPPTH5Queue(e,t);else{var i=this.renderMode===s.RenderMode.H5;i&&(this.ppth5Info.targetPage=e,this.ppth5Info.targetStep=t);var r=this.ppth5Info.loaded,n=this.serviceHandle.getStore();if(i&&(r||!r&&(e>1||t>1))){if(n.multiDocsQueue&&n.syncQueueRuning){for(var h=!0,f=this.id,p=n.multiDocsQueue.length-1;p>=0;p--){var l=n.multiDocsQueue[p];if(l.id==f&&l.args.page==e&&l.args.step==t){h=!1;break}}if(h){var u={p:this.parent,id:this.id,loaded:r,args:[e,t,o]};return n.multiDocsQueue.push(u),void a.Logger.info(c("h5_mdqueue_push"),JSON.stringify({task:u}))}}n.syncQueueRuning=!0,n.multiDocsQueue=n.multiDocsQueue||[]}n.multiDocsQueue?this.runGotoPageQueue(e,t,o,"execMultiDocsQueue"):(-1!==this.ifCanvasLoadedScrollTop&&(this.ifCanvasLoadedScrollTop=this.getScrollTopByPage(e)),this.execGotoPage(e,t,o)),a.Logger.info(c("flipPage"),JSON.stringify({id:this.id,params:{page:e,step:t}}))}},e.prototype.previousStep=function(e){1===this.ppth5Info.page&&1===this.ppth5Info.step||(e=void 0===e||!!e,!this.zoomInfo.enable&&e||(this.ppth5Info.notify=e,this.postMessage2iframe("previousStep",[e]),a.Logger.info(c("previousStep"),JSON.stringify({id:this.id,notify:e}))))},e.prototype.nextStep=function(e){e=void 0===e||!!e,!this.zoomInfo.enable&&e||(this.ppth5Info.notify=e,this.postMessage2iframe("nextStep",[e]),a.Logger.info(c("nextStep"),JSON.stringify({id:this.id,notify:e})))},e.prototype.switchSheet=function(e){this.getFileType()===s.ZegoDocsViewFileType.ZegoDocsViewFileTypeELS&&this.viewInfo.sheet!==e&&e>=0&&e<this.fileInfo.file_list.length&&(this.viewInfo.sheet=e,this.vpageDrawCache={},this.loadCurrentSheet(!1,!0),a.Logger.info(c("switchSheet"),JSON.stringify({id:this.id,params:e})))},e.prototype.setScaleFactor=function(e,t,o){var i=this,r=e;(!r||r<1)&&(r=1);var n=this.zoomInfo.zoom;if(n!==r){if(this.renderMode===s.RenderMode.H5){if(!this.iframeDom)return;this.zoomInfo.zoom=r}else{if(!this.canvasArray[0])return;this.zoomInfo.zoom=r,this.resetAllCanvas()}a.Logger.info(c("setScaleFactor"),JSON.stringify({zoom:r,x:t,y:o}));var h=this.viewInfo,f=h.viewWidth,p=h.viewHeight,l=h.height,u=h.scrollTop;if(this.setDocsViewDomOverflow(),this.renderMode===s.RenderMode.PDF){var d=this.getDocViewChild();d.style.cssText+="transform:scale("+r+");",(d=this.renderDom.firstChild).style.cssText+="transform:scale("+r+");",(d=this.renderDom.lastChild).style.cssText+="width:"+f*r+"px;height:"+l*r+"px;",this.postZoomDragMessage(0,0,!1),this.viewInfo.ticking=!0;var g=f*(r-1)*.5,v=u;this.zoomInfo.scrollChanged&&(this.zoomInfo.scrollChanged=r>1,v+=.5*p*(1-n)/n),v=v*r+p*(r-1)*.5,this.docDom.scrollTo(g,v),this.renderDom.scrollTo(g,v),setTimeout((function(){i.viewInfo.ticking=!1,i.postZoomDragMessage(0,0,!0)}),34)}else{g=f*(1-r)*.5,v=p*(1-r)*.5;this.zoomInfo.tx=g,this.zoomInfo.ty=v,this.setDocsViewDomTransform(g,v)}this.wbId||(this.zoomInfo.drag=r>1,this.docDom.style.cursor=r>1?"move":"auto"),this.renderMode!==s.RenderMode.H5&&this.loadCurrentSheet()}},e.prototype.getScaleFactor=function(){return{scaleFactor:this.zoomInfo.zoom,scaleOffsetX:0,scaleOffsetY:0}},e.prototype.playAnimation=function(e){this.postMessage2iframe("triggerElementsClick",[e]),a.Logger.info(c("playAnimation"),e)},e.prototype.stopPlay=function(e){this.postMessage2iframe("stopPlay",[e]),a.Logger.info(c("stopPlay"),e)},e.prototype.addDOMEventListener=function(e,t){this.domEventListeners||(this.domEventListeners={}),this.domEventListeners[e]=t},e.prototype.enableDOMEvent=function(e){var t=this.docDom&&this.docDom.parentElement;t&&this.renderMode===s.RenderMode.H5&&(t.style.cssText+="pointer-events:"+(e?"initial":"none")+";")},e}();t.ZegoDocsViewImpl=h},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IMG_LOADING=t.IMG_ERROR=void 0;var i=new Image;t.IMG_ERROR=i,i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAN90lEQVR4Xu1dC3BcVRn+/7tJ82ybNu8mezZt6qAoLx2dmm42TZPY2g74Qh3EQZ6KOoMoA47gW1EHfOCgIg8RcQYVEWRgoG0SQjbbUhwc0aK0hdLee7N59f3MY3fvcQ6kJU33ce9/d3Pv9p4z02mb/N/5z/m+797de+55IMjiaQbQ072XnQdpAI+bQBpAGsDjDHi8+/IOIA3gcQY83n15B5AG8DgDHu++vANIA3icAY93X94BpAE8zsCs7quq+jAi1iNijHMeB4CY+CP+LX528ueIGJ/+2Zt/K4oSTyQSGwOBwOZ8YlTeAWaopapqEBEHiAI+yRj7KBHrGEwaYAb1mqZFAGAlRQ1FUaoaGxv3U7BOYqQBptkfHBy8wjCMP1DE4JzfEQgEvk7BOo2RBphWQNO0IQCoJwjCGWMKAecKiDQAAKiq+j1E/DZRkasZY78nYh2Hed4AmqYtAYAoUYlXGWPnErGugHneALqu/5Fz/lmKGoZhtDQ1Nb1AwboFk9EA3f0D303VWEQMcM5Vt3TGajsWlpcH6qorr7SKE/ETk7Ht6tDQXyjYbGIyadDV1ppSP9GOjAboCUf6AGBV0kZzeBkQLsxmh+ayLn99LZQUFZFS7tIHIZEwSNisgjJo0BkKptXYswZYUF4GdVWVJC0OHD4C+w4eImGzDpIGoFHa7G8An89HAu/co5FwOQFJA1intbJiIYg/lDKybz8cOXacAs0NRhrAGq8FPh8s8zdYA01HT8VisCc6TMLmDCQNYI3a+upKmF9WZg00Ha0Pj8L45CQJmzOQCwzgkm9DmSkuKylZ2FBbfVHmyDMjxicm9uojY/+lYHOK4VCR7kksp08BPMHbu9pbn89pB7NYua7rL3DOV1CqnDdvXm1dXd0YBZtLTHffwCr0oXhUT1qkAaZp0TRNDPhQx+x/xBi7LZdCUuuWBjDJnKZp4uqtNhk+MyzGGJtHwM0JRBrABM2apv0QAKhX8FWMsYdMpHEkRBogA+0jIyM1U1NToxR1EHGb3+8/n4KdK4w0QAamdV1/hHN+GUUQznlrIBAQ08RcW6QB0kgTjUZbEokEaZYu5/yxQCDwSdcqP90waYA0Cmma9iIAfIAiYiKRqF+6dOkIBTuXGM8aoK+vrzzm812qcLwIEM/nnG/1+XDblKJsWNvSckBV1SsQkTTJEwBc+9g321yeNEBv/5YWUIz7OId3n3G1IQyBAbecsyxwF+e8inA1TjLGigk4RyCeM8CmcPhKBZS0Azp23vYZhnFNU1PTg46oSUjqKQM829fXVOgreAUAU77N8fkUaPY3Eqh8E/IfxtgFVLATOE8ZoCccuQMAbk5HdH11FcwvK6Vq0cYYC1PBTuA8ZoDNGwD4mlREFxcVAauvJemAiI/5/X7XP/Z5+ktgTzhyGAAWpFKY1ddBcRF52L6BMSZWB+VV8dYdYCDyL+DJZyHbmeSJiD/x+/3fyCvlvTgQ1B2O3IMA1ycTqpk1gk8hLdEbZ4yRvzQ4bRqP3QEG1gLHZ2eTbuexDxGv9fv9v3NaSGp+TxlAkNQbjtzDZ9wFxFUvrn5iybvHPk9/CTzZebFcDRG/I/5fV10JC4iTPBFxld/v7yeaxxUwz90BTrIuhoPLyopuXlJTTd2W5XHG2CdcoaKNRnjWAIKz4eHh6lgsRpqoaRjGLU1NTXfa4N4VUE8bQCig6/oqznnKWbHpVDIMY31TU9MzrlCS2AjPG0DwpmnalwHgVxQO4/F407Jly/J2ibs0wLTqmqb9BgC+SDDBMcbYfALOFRBpgBkyaJomvtGHCMq8yBgjLRgh5MoqRBpgFp2apu0DAMrC/wcZY9dkVZ05qEwaYBbJu3fvrvP5fNQlvDcxxn4+B7plLYU0QBIqVVXtQMQeIstrGWMbzWB7BgbWcgNFrtXAjRpAfreiKE+uDgZ3mMFnI0YaIAWLqqregIi/pJCsKIq/sbFxMBV2UySyROF4G3D+pWQxnMPlXW3BRyi5rWKkAdIwpqrqvYj4eaukAsBhxlhFMlxPf+TTgHA7ADSnqxcBr+oIrcz5kjJpgAzqqqoaQUTLG0Bzzl8IBAItM6vvDoevQ1DuM2soBLiuIxR8wGw8JU4awARrqqoeRMSkV3Q6OOf8gUAgcJ2I6QlHxFV/q4l0p4Xk+uNAGsCEIjt27GgoKSlJ+ZmewQRffU3VLwaA1SZSpQgxPtYZCv2djk+NlAYwyWo0Gu1KJBKbTIafFjY4OgYnxico0FMY5Limo20lKX+6xNIAFmQZHBy80TCMX1iAnAp9Q49CPJGgQE9hEgk8b037yldsVTILLA1gkU1d1+/nnF9rEQYJw4BdGulT5LRUvkSspL293d7tZEaN0gBWlXzrFfIWzvkHrULHJyZBHyHtNXEqFefweldb8B1Wc6eKlwYgMqlpWto1BqmqPXz0GIzuP0DM+haMA/9TV6j1M7YqmQZLAxBZjEaj/kQiQdr0d+zAQTh05Cgx8zQM8abO1pW23zuctQbYuHFjma+o/FzuM/Z3tba+YY/t5Ghd19dyzs+YZm4m1+DIGJyYsPdRrihw+eqgvSHjs84A3eHIjQj8KgA8tTkTB/gnIL+vq7XV9CicGRFFjKZpNwHAT83Gz4zbpUchYfPJADl2dLStfI6SX2DOGgP0hMPnAvhuB+CpZ/kiPAsJ+HHnqiD1cMekPG/fufPV0uLid1oVIRtPBgiwl4OxqjMU+p/V/GeNAfq2bFmeiPPHAfh55kjI3shab//ANzniD6gLS7PxZIAAm2MFyiViaxtz/X87Ku/vAL29mwO80HgcAN9rpfO+RGxRe3u7rY2qu/sHrkbEU8vClgf8oGDGQ1TOaOaho8dgzOaTAQD8rTMUvNQKB3l/BwiHw/VToHQDJNnrJzMTE52hYEnmsOQR3eEtaxCMpwCg8GREYUEBLG0Up8hZL2P7D8KhozafDADu7AwFb7GSPW/vAE/19VWVFhRu5Tz9e/V0ZCDC9o7W4LusEPbmVdPffx6iT4gfmI21s8NINp4MQIHrO4PBe832KS8N8MzWrQvmTcVfBQDa5XY6Oxs6Q8EPmyVsQzhcX8CVJwHh/bMxZaUl0FBD2U8aIBsDRNPtiYEB6ztXBcWdMWPJOwP09fUVJ3yFYieORRl7ZzKAc/hrV1vwU5nCX3rppcKDJyaeRoAPJYtdzhpBIewxYBgcXtf0TOlN/x4RtxtgrDcz/pFXBnj00Ud9lXVLjnIA8md3KhYReC8Av7UjFPpHsphN4XCHD5QbOMAlyX5fs3gRVCygrQ8ZGtsLx06MmxbYTCDn8ExXW3B9pti8MkBPOMIzdcjm748iwq8NQ3mkq61lm6jruYGB9xkcxa4iKd8Ain2FxGMgpRw9fgKG94qlCNkvCHB3Ryh4Q7qa88YAPeGIeI1Wk32aUtYoxvnFEHLyU09nwJoa6mFe4amHAUtNfE3VgfMc+hr5jZ2trSlnN+eFAbr7I9sQ4T2WmJ2j4MUVC6GKeobg3v1w5PgcnCGIysWdrS1PJ6PE9QboDW/u4cA75khPS2kKCwtgaQPtQeT4+DhER/daymcjeA+AsT7ZcLGrDdA7sJl8WIMNskxD/XW1UFKcH4dHI2Dv5LHD69etW3fawYWuNUDPwOa7gPOvmFZjjgMXzi+H2srFpKxi2FcM/8514cDv7wq1nrbQxZUGyNSouSZudj47x8dm4+WPnf7PPqsxE9eOnBuYqVF2CMgGdklNFZSX0vaG3D04BLF4PBvNINUhDUCi7W1QeWkJLCEO9+47eAgOHD5iswX24NIANvgTw7zLGpeQhnsnp2KgDlG3HbDR6FlQaQAbXNZULoaK+eWkGtShEZicmiJhswmSBiCyWVpSDI21tIFIcdsXt383FGkAogpiooeY8GG1iC984oufW4o0AEEJO7uJZ2WSB6HNqSDSABbJLCkqAj/xGBmx+EMsAnFTkQawqIYQX5jAasnGlG+rOc3ESwOYYWk6ZtGC+VC9mDbxKBeTPCw0PWVo3hggG521U0fl4ormqkULSfvzTMXjG3er0Z/YyZ9LbFd76/Mn68806urIUHAuO2+2bk3TngAAy2cJcM5j8Xi8urm5Wawedn2RBkgikaqqX0DE31LU45x/LhAIPEzBOoGRBpjFuq7ryznn/wYAytueJxhjH3dCSGpORw0AAA9xzl211z6rr/1ISXHxhRRC9wyN3DU5OZkXt/6T/UNEsbjlylT9zel3AODwMmDygxwpAtjFiMOjxCFSlJKVTR8oie1iMmjgGQOISR7imZ8y3Cs2ehAjfnlZpAHeks3Owg7xmle87s3LIg0AkO+TPGwZz+sGEJM8xGteyqnhE5NToA2P2OLfcbDXDVC1qAIWL0x5onxaffThURifPG2WteN6Wm7AHBkgebs4VACCYzMl5peVLqqvrrrAMmniQICjx/TR/Qd2UbCuwmTQoDMUbE/XXuv7obik92Kl8YoVK8SxMBnX/iVp8k7G2Dku6YqjzchbA2ia9i0A+D6FPURc5/f7SfsDUvK5GZOXBohGoy3xeLwPEecRyL2XMSaWi8sCAHlpAF3Xn+acZ9w8YbbCnPNRRVGW+v3+7O7mkMdWyjsDaJr2NQD4GZHzyxhjfyZiz0pY3hngrFTBwU5JAzhIvhtSSwO4QQUH2yAN4CD5bkgtDeAGFRxsgzSAg+S7IbU0gBtUcLAN0gAOku+G1NIAblDBwTZIAzhIvhtSSwO4QQUH2yAN4CD5bkgtDeAGFRxsgzSAg+S7IbU0gBtUcLAN0gAOku+G1P8HXF8j+YvhwMkAAAAASUVORK5CYII=";t.IMG_LOADING='<path d="M834.7648 736.3584a5.632 5.632 0 1 0 11.264 0 5.632 5.632 0 0 0-11.264 0z m-124.16 128.1024a11.1616 11.1616 0 1 0 22.3744 0 11.1616 11.1616 0 0 0-22.3744 0z m-167.3216 65.8944a16.7936 16.7936 0 1 0 33.6384 0 16.7936 16.7936 0 0 0-33.6384 0zM363.1616 921.6a22.3744 22.3744 0 1 0 44.7488 0 22.3744 22.3744 0 0 0-44.7488 0z m-159.744-82.0224a28.0064 28.0064 0 1 0 55.9616 0 28.0064 28.0064 0 0 0-56.0128 0zM92.672 700.16a33.6384 33.6384 0 1 0 67.2256 0 33.6384 33.6384 0 0 0-67.2256 0zM51.2 528.9984a39.168 39.168 0 1 0 78.336 0 39.168 39.168 0 0 0-78.336 0z m34.1504-170.0864a44.8 44.8 0 1 0 89.6 0 44.8 44.8 0 0 0-89.6 0zM187.904 221.7984a50.432 50.432 0 1 0 100.864 0 50.432 50.432 0 0 0-100.864 0zM338.432 143.36a55.9616 55.9616 0 1 0 111.9232 0 55.9616 55.9616 0 0 0-111.9744 0z m169.0112-4.9152a61.5936 61.5936 0 1 0 123.2384 0 61.5936 61.5936 0 0 0-123.2384 0z m154.7776 69.632a67.1744 67.1744 0 1 0 134.3488 0 67.1744 67.1744 0 0 0-134.3488 0z m110.0288 130.816a72.8064 72.8064 0 1 0 145.5616 0 72.8064 72.8064 0 0 0-145.5616 0z m43.7248 169.472a78.3872 78.3872 0 1 0 156.8256 0 78.3872 78.3872 0 0 0-156.8256 0z" fill="#cdcdcd"></path>'},function(e,t,o){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsViewService=void 0;var s=o(62),a=o(4),c=o(3),h=c.getLogAction.bind(null,"docs.s."),f=function(e){function t(t){var o=e.call(this)||this;return o.listeners={},o.zegoDocs=t,o}return r(t,e),t.prototype.setTestEnv=function(e){this.zegoDocs.setTestEnv(e),c.Logger.info(h("setTestEnv"),JSON.stringify({params:e}))},t.prototype.setConfig=function(e,t){var o,i;return i=e===a.ZegoConfigKey.Domain||e===a.ZegoConfigKey.DynamicPPTHD?this.zegoDocs.setConfig(e,t):this.setStore(((o={})[e]=t,o)),c.Logger.info(h("setConfig"),JSON.stringify({params:{key:e,value:t},result:i})),i},t.prototype.getConfig=function(e){var t;return t=e===a.ZegoConfigKey.Domain||e===a.ZegoConfigKey.DynamicPPTHD?this.zegoDocs.getConfig(e):this.getStore()[e],c.Logger.info(h("getConfig"),JSON.stringify({params:e,result:t})),t},t.prototype.registerEventHandler=function(e,t,o){this.listeners[t]=this.listeners[t]||{},this.listeners[t][e]=o},t.prototype.load=function(e,t,o){var i=this;return this.zegoDocs.load(t).then(this.resolveLoad.bind(this,e,t,o),(function(r){return i.zegoDocs.load(t).then(i.resolveLoad.bind(i,e,t,o),(function(e){throw e=e||{code:a.ZegoDocsViewError.ZegoDocsViewErrorNetworkTimeout,message:"网络超时"},i.triggerEventListener("onError",n(n({},t),e)),c.Logger.error(h("load_error"),JSON.stringify({params:t,result:e})),e}))}))},t.prototype.upload=function(e){var t=this;return e.onProgress=function(o){t.triggerEventListener("onUpload",Object.assign(o,e.extraInfo))},this.zegoDocs.upload(e).then((function(t){return c.Logger.info(h("upload"),JSON.stringify({params:e,result:t})),t}))},t.prototype.cancelUpload=function(e){return this.zegoDocs.cancelUpload(e).then((function(t){return c.Logger.info(h("cancelUpload"),JSON.stringify({params:e,result:t})),t}))},t.prototype.download=function(e){return this.zegoDocs.download(e).then((function(t){return c.Logger.info(h("download"),JSON.stringify({params:e,result:t})),t}))},t.prototype.init=function(e){},t.prototype.setLogFolder=function(e){},t.prototype.setCacheDirectory=function(e){},t.prototype.getPageImage=function(e,t){var o=this.listeners.onDocsGetPDFPageImage[e];o&&o(this.transImage(t))},t.prototype.resolveLoad=function(e,t,o,i){if(o&&i.fileType!==a.ZegoDocsViewFileType.ZegoDocsViewFileTypeAudio&&i.fileType!==a.ZegoDocsViewFileType.ZegoDocsViewFileTypeVideo){var r=this.transLoadFile(i),s=this.listeners.onDocsLoadPdf[e];s&&setTimeout((function(){return s(r)}))}var f=n(n({},i),{fileUrls:void 0,notes:void 0,thumbnails:void 0,file_list:void 0});return c.Logger.info(h("load"),JSON.stringify({params:t,result:f})),i},t.prototype.transLoadFile=function(e){return n(n({},e),{user_data:e.fileID,document_type:e.fileType,page_count:e.pageCount})},t.prototype.transImage=function(e){var t=e.file_id,o=e.virtual_page_number,i=e.virtual_start,r=e.res,n=e.sheet,s=r.document_type===a.ZegoDocsViewFileType.ZegoDocsViewFileTypeIMG,c=r.file_list[n].page_list[o-i-1].src;return{error_code:0,file_id:t,image_data:s?"":c,image_path:s?c:"",virtual_page_number:o}},t}(s.ZegoDocsViewServiceBase);t.ZegoDocsViewService=f},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDocsViewServiceBase=void 0;var i=o(4),r=function(){function e(){var e;this.store=((e={})[i.ZegoConfigKey.PptStepMode]=1,e[i.ZegoConfigKey.DisableH5ImageDrag]=!1,e),this.customListeners={onError:[],onLoadFile:[],onUpload:[],onScroll:[],onStepChange:[],onPlayAnimation:[],onRenderState:[],onViewMessage:[],onInnerOnceMessage:[]}}return e.prototype.setStore=function(e){return Object.assign(this.store,e),!0},e.prototype.getStore=function(){return this.store},e.prototype.addEventListener=function(e,t){return!!this.customListeners[e]&&("function"==typeof t&&(-1==this.customListeners[e].indexOf(t)&&this.customListeners[e].push(t),!0))},e.prototype.removeEventListener=function(e,t){if(!this.customListeners[e])return!1;var o=this.customListeners[e];return t?o.splice(o.indexOf(t),1):this.customListeners[e]=[],!0},e.prototype.triggerEventListener=function(e,t){var o=this.customListeners[e];o&&o.forEach((function(e){return e(t)}))},e}();t.ZegoDocsViewServiceBase=r}])}));